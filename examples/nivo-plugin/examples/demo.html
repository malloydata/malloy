<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Malloy Nivo Plugin Demo</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background: #f5f5f5;
        }
        h1 {
            color: #333;
            border-bottom: 3px solid #4CAF50;
            padding-bottom: 10px;
        }
        .demo-section {
            background: white;
            padding: 20px;
            margin: 20px 0;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .demo-section h2 {
            color: #555;
            margin-top: 0;
        }
        .code-block {
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 4px;
            padding: 15px;
            overflow-x: auto;
            font-family: 'Courier New', monospace;
            font-size: 14px;
        }
        .visualization-container {
            margin-top: 20px;
            min-height: 400px;
            border: 1px solid #ddd;
            border-radius: 4px;
            padding: 10px;
        }
        .info-box {
            background: #e3f2fd;
            border-left: 4px solid #2196F3;
            padding: 15px;
            margin: 15px 0;
        }
        .warning-box {
            background: #fff3e0;
            border-left: 4px solid #ff9800;
            padding: 15px;
            margin: 15px 0;
        }
    </style>
</head>
<body>
    <h1>üé® Malloy Nivo Plugin Demo</h1>

    <div class="info-box">
        <strong>‚ÑπÔ∏è About This Demo</strong><br>
        This page demonstrates how to integrate Nivo charts with Malloy using custom plugins.
        The examples below show both bar charts and pie charts powered by Nivo's React components.
    </div>

    <div class="demo-section">
        <h2>üìä Bar Chart Example</h2>
        <p>Visualizing sales data by product using Nivo's ResponsiveBar component.</p>

        <h3>Malloy Query:</h3>
        <div class="code-block">
query: product_sales is sales -> {
  nest: by_product is {
    group_by: product_name
    aggregate: total_revenue is sum(revenue)
    order_by: total_revenue desc
    limit: 10
  } # nivo_bar_chart
}
        </div>

        <h3>TypeScript Setup:</h3>
        <div class="code-block">
import { MalloyRenderer } from '@malloydata/render';
import { NivoBarChartPluginFactory } from '@malloy-examples/nivo-plugin';

const renderer = new MalloyRenderer({
  plugins: [NivoBarChartPluginFactory],
  pluginOptions: {
    nivo_bar_chart: {
      colorScheme: 'category10',
      showLegends: true,
      padding: 0.3
    }
  }
});
        </div>

        <div class="visualization-container">
            <p style="text-align: center; color: #666;">
                üìà Visualization would render here when integrated with Malloy
            </p>
        </div>
    </div>

    <div class="demo-section">
        <h2>ü•ß Pie Chart Example</h2>
        <p>Showing market share distribution using Nivo's ResponsivePie component.</p>

        <h3>Malloy Query:</h3>
        <div class="code-block">
query: market_share is sales -> {
  nest: by_category is {
    group_by: category
    aggregate: total is sum(revenue)
  } # nivo_pie_chart
}
        </div>

        <h3>TypeScript Setup:</h3>
        <div class="code-block">
import { NivoPieChartPluginFactory } from '@malloy-examples/nivo-plugin';

const renderer = new MalloyRenderer({
  plugins: [NivoPieChartPluginFactory],
  pluginOptions: {
    nivo_pie_chart: {
      colorScheme: 'nivo',
      innerRadius: 0.5,  // Creates donut chart
      enableArcLinkLabels: true
    }
  }
});
        </div>

        <div class="visualization-container">
            <p style="text-align: center; color: #666;">
                ü•ß Visualization would render here when integrated with Malloy
            </p>
        </div>
    </div>

    <div class="demo-section">
        <h2>üöÄ Getting Started</h2>

        <h3>1. Install Dependencies</h3>
        <div class="code-block">
npm install @malloy-examples/nivo-plugin
npm install @malloydata/render react react-dom
        </div>

        <h3>2. Register Plugins</h3>
        <div class="code-block">
import { MalloyRenderer } from '@malloydata/render';
import {
  NivoBarChartPluginFactory,
  NivoPieChartPluginFactory
} from '@malloy-examples/nivo-plugin';

const renderer = new MalloyRenderer({
  plugins: [
    NivoBarChartPluginFactory,
    NivoPieChartPluginFactory
  ]
});
        </div>

        <h3>3. Tag Fields in Malloy</h3>
        <div class="code-block">
query: my_visualization is data -> {
  nest: analysis is {
    group_by: dimension_field
    aggregate: measure_field
  } # nivo_bar_chart  // or # nivo_pie_chart
}
        </div>
    </div>

    <div class="demo-section">
        <h2>‚öôÔ∏è Configuration Options</h2>

        <h3>Bar Chart Options</h3>
        <div class="code-block">
{
  colorScheme: 'category10',      // Nivo color scheme
  showLegends: true,              // Show/hide legends
  enableAnimations: true,         // Enable/disable animations
  padding: 0.3,                   // Bar padding (0-1)
  layout: 'vertical'              // 'vertical' or 'horizontal'
}
        </div>

        <h3>Pie Chart Options</h3>
        <div class="code-block">
{
  colorScheme: 'nivo',            // Nivo color scheme
  enableSliceLabels: true,        // Show slice labels
  enableArcLinkLabels: true,      // Show arc link labels
  innerRadius: 0,                 // 0=pie, >0=donut (0-1)
  padAngle: 0.7,                  // Angle between slices
  cornerRadius: 3                 // Corner radius of slices
}
        </div>
    </div>

    <div class="warning-box">
        <strong>‚ö†Ô∏è Note:</strong> This is a demonstration page. To see actual visualizations,
        you need to integrate this plugin with your Malloy application and execute queries
        against real data sources.
    </div>

    <div class="demo-section">
        <h2>üìö Resources</h2>
        <ul>
            <li><a href="https://github.com/malloydata/malloy">Malloy GitHub Repository</a></li>
            <li><a href="https://malloydata.github.io/malloy/">Malloy Documentation</a></li>
            <li><a href="https://nivo.rocks/">Nivo Documentation</a></li>
            <li><a href="https://nivo.rocks/components">Nivo Component Explorer</a></li>
        </ul>
    </div>
</body>
</html>
