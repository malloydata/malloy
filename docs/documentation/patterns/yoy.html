---
layout: documentation
title: Malloy Documentation
footer: /generated/footers/patterns/yoy.html
---

<div class="document">
      <h1>
        <a id="year-over-year-analysis" class="header-link anchor" href="#year-over-year-analysis">
          Year Over Year Analysis
        </a>
      </h1>
    <p>There are a couple of different ways to go about this in Malloy.</p>

      <h2>
        <a id="method-1-pivoting-a-visualization" class="header-link anchor" href="#method-1-pivoting-a-visualization">
          Method 1: Pivoting a Visualization
        </a>
      </h2>
    <p>Compare performance of different years on the same scale.  Line charts take the X-Axis, Y-Axis and Dimensional Axis as parameters.
In this Case, the X-Axis is <code class="language-malloy" style="background-color: #FBFBFB"><span class="line"><span style="color: #001080">month_of_year</span></span></code>, the Y-Axis is <code class="language-malloy" style="background-color: #FBFBFB"><span class="line"><span style="color: #001080">flight_count</span></span></code> and the Dimensional Axis is the year.</p>
<pre class="language-malloy" style="background-color: #FBFBFB"><span class="line"><span style="color: #AF00DB">source</span><span style="color: #000000">: </span><span style="color: #001080">flights</span><span style="color: #000000"> </span><span style="color: #AF00DB">is</span><span style="color: #000000"> </span><span style="color: #795E26">table</span><span style="color: #000000">(</span><span style="color: #A31515">&#39;malloy-data.faa.flights&#39;</span><span style="color: #000000">) {</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #AF00DB">measure</span><span style="color: #000000">: </span><span style="color: #001080">flight_count</span><span style="color: #000000"> </span><span style="color: #AF00DB">is</span><span style="color: #000000"> </span><span style="color: #795E26">count</span><span style="color: #000000">()</span></span>
<span class="line"><span style="color: #000000">}</span></span>
<span class="line"></span>
<span class="line"><span style="color: #AF00DB">query</span><span style="color: #000000">: </span><span style="color: #001080">flights</span><span style="color: #000000"> -&gt; {</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #AF00DB">nest</span><span style="color: #000000">: </span><span style="color: #001080">year_over_year</span><span style="color: #000000"> </span><span style="color: #AF00DB">is</span><span style="color: #000000"> {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #AF00DB">group_by</span><span style="color: #000000">: </span><span style="color: #001080">month_of_year</span><span style="color: #000000"> </span><span style="color: #AF00DB">is</span><span style="color: #000000"> </span><span style="color: #795E26">month</span><span style="color: #000000">(</span><span style="color: #001080">dep_time</span><span style="color: #000000">)</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #AF00DB">aggregate</span><span style="color: #000000">: </span><span style="color: #001080">flight_count</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #AF00DB">group_by</span><span style="color: #000000">: </span><span style="color: #001080">flight_year</span><span style="color: #000000"> </span><span style="color: #AF00DB">is</span><span style="color: #000000"> </span><span style="color: #001080">dep_time</span><span style="color: #000000">.</span><span style="color: #0000FF">year</span></span>
<span class="line"><span style="color: #000000">  }</span></span>
<span class="line"><span style="color: #000000">}</span></span></pre><div class="result-outer medium">
    <div class="result-controls-bar">
      <span class="result-label">QUERY RESULTS</span>
      <div class="result-controls">
        <button class="result-control" selected data-result-kind="html">HTML</button>
        <button class="result-control"  data-result-kind="json">JSON</button>
        <button class="result-control"  data-result-kind="sql">SQL</button>
      </div>
    </div>
    <div class="result-middle" data-result-kind="html" selected>
      <div class="result-inner">
        <table style="vertical-align: top; border-collapse: collapse; width: 100%;"><thead><tr><th style="padding: 8px; text-align: left;">year_​over_​year</th></tr></thead><tbody><tr><td style="padding: 8px; vertical-align: top;"><div><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" class="marks" width="374" height="150" viewBox="0 0 374 150"><g fill="none" stroke-miterlimit="10" transform="translate(85,13)"><g class="mark-group role-frame root" role="graphics-object" aria-roledescription="group mark container"><g transform="translate(0,0)"><path class="background" aria-hidden="true" d="M0.5,0.5h150v100h-150Z" stroke="#888"></path><g><g class="mark-group role-axis" aria-hidden="true"><g transform="translate(0.5,100.5)"><path class="background" aria-hidden="true" d="M0,0h0v0h0Z" pointer-events="none"></path><g><g class="mark-rule role-axis-grid" pointer-events="none"><line transform="translate(14,-100)" x2="0" y2="100" stroke="#888" stroke-width="1" opacity="1"></line><line transform="translate(41,-100)" x2="0" y2="100" stroke="#888" stroke-width="1" opacity="1"></line><line transform="translate(68,-100)" x2="0" y2="100" stroke="#888" stroke-width="1" opacity="1"></line><line transform="translate(95,-100)" x2="0" y2="100" stroke="#888" stroke-width="1" opacity="1"></line><line transform="translate(123,-100)" x2="0" y2="100" stroke="#888" stroke-width="1" opacity="1"></line><line transform="translate(150,-100)" x2="0" y2="100" stroke="#888" stroke-width="1" opacity="1"></line></g></g><path class="foreground" aria-hidden="true" d="" pointer-events="none" display="none"></path></g></g><g class="mark-group role-axis" aria-hidden="true"><g transform="translate(0.5,0.5)"><path class="background" aria-hidden="true" d="M0,0h0v0h0Z" pointer-events="none"></path><g><g class="mark-rule role-axis-grid" pointer-events="none"><line transform="translate(0,100)" x2="150" y2="0" stroke="#888" stroke-width="1" opacity="1"></line><line transform="translate(0,69)" x2="150" y2="0" stroke="#888" stroke-width="1" opacity="1"></line><line transform="translate(0,38)" x2="150" y2="0" stroke="#888" stroke-width="1" opacity="1"></line><line transform="translate(0,8)" x2="150" y2="0" stroke="#888" stroke-width="1" opacity="1"></line></g></g><path class="foreground" aria-hidden="true" d="" pointer-events="none" display="none"></path></g></g><g class="mark-group role-axis" role="graphics-symbol" aria-roledescription="axis" aria-label="X-axis titled 'month_of_year' for a linear scale with values from 1 to 12"><g transform="translate(0.5,100.5)"><path class="background" aria-hidden="true" d="M0,0h0v0h0Z" pointer-events="none"></path><g><g class="mark-rule role-axis-tick" pointer-events="none"><line transform="translate(14,0)" x2="0" y2="5" stroke="#ddd" stroke-width="1" opacity="1"></line><line transform="translate(41,0)" x2="0" y2="5" stroke="#ddd" stroke-width="1" opacity="1"></line><line transform="translate(68,0)" x2="0" y2="5" stroke="#ddd" stroke-width="1" opacity="1"></line><line transform="translate(95,0)" x2="0" y2="5" stroke="#ddd" stroke-width="1" opacity="1"></line><line transform="translate(123,0)" x2="0" y2="5" stroke="#ddd" stroke-width="1" opacity="1"></line><line transform="translate(150,0)" x2="0" y2="5" stroke="#ddd" stroke-width="1" opacity="1"></line></g><g class="mark-text role-axis-label" pointer-events="none"><text text-anchor="middle" transform="translate(13.636363636363637,15)" font-family="var(--malloy-font-family, 'Roboto')" font-size="10px" fill="var(--malloy-label-color, #505050)" opacity="1">2</text><text text-anchor="middle" transform="translate(40.90909090909091,15)" font-family="var(--malloy-font-family, 'Roboto')" font-size="10px" fill="var(--malloy-label-color, #505050)" opacity="1">4</text><text text-anchor="middle" transform="translate(68.18181818181817,15)" font-family="var(--malloy-font-family, 'Roboto')" font-size="10px" fill="var(--malloy-label-color, #505050)" opacity="1">6</text><text text-anchor="middle" transform="translate(95.45454545454545,15)" font-family="var(--malloy-font-family, 'Roboto')" font-size="10px" fill="var(--malloy-label-color, #505050)" opacity="1">8</text><text text-anchor="middle" transform="translate(122.72727272727273,15)" font-family="var(--malloy-font-family, 'Roboto')" font-size="10px" fill="var(--malloy-label-color, #505050)" opacity="1">10</text><text text-anchor="end" transform="translate(150,15)" font-family="var(--malloy-font-family, 'Roboto')" font-size="10px" fill="var(--malloy-label-color, #505050)" opacity="1">12</text></g><g class="mark-rule role-axis-domain" pointer-events="none"><line transform="translate(0,0)" x2="150" y2="0" stroke="#ddd" stroke-width="1" opacity="1"></line></g><g class="mark-text role-axis-title" pointer-events="none"><text text-anchor="middle" transform="translate(75,30)" font-family="var(--malloy-font-family, 'Roboto')" font-size="12px" font-weight="500" fill="var(--malloy-title-color, #505050)" opacity="1">month_of_year</text></g></g><path class="foreground" aria-hidden="true" d="" pointer-events="none" display="none"></path></g></g><g class="mark-group role-axis" role="graphics-symbol" aria-roledescription="axis" aria-label="Y-axis titled 'flight_count' for a linear scale with values from 0 to 650,000"><g transform="translate(0.5,0.5)"><path class="background" aria-hidden="true" d="M0,0h0v0h0Z" pointer-events="none"></path><g><g class="mark-rule role-axis-tick" pointer-events="none"><line transform="translate(0,100)" x2="-5" y2="0" stroke="#ddd" stroke-width="1" opacity="1"></line><line transform="translate(0,69)" x2="-5" y2="0" stroke="#ddd" stroke-width="1" opacity="1"></line><line transform="translate(0,38)" x2="-5" y2="0" stroke="#ddd" stroke-width="1" opacity="1"></line><line transform="translate(0,8)" x2="-5" y2="0" stroke="#ddd" stroke-width="1" opacity="1"></line></g><g class="mark-text role-axis-label" pointer-events="none"><text text-anchor="end" transform="translate(-7,103)" font-family="var(--malloy-font-family, 'Roboto')" font-size="10px" fill="var(--malloy-label-color, #505050)" opacity="1">0</text><text text-anchor="end" transform="translate(-7,72.23076923076923)" font-family="var(--malloy-font-family, 'Roboto')" font-size="10px" fill="var(--malloy-label-color, #505050)" opacity="1">200,000</text><text text-anchor="end" transform="translate(-7,41.46153846153846)" font-family="var(--malloy-font-family, 'Roboto')" font-size="10px" fill="var(--malloy-label-color, #505050)" opacity="1">400,000</text><text text-anchor="end" transform="translate(-7,10.692307692307686)" font-family="var(--malloy-font-family, 'Roboto')" font-size="10px" fill="var(--malloy-label-color, #505050)" opacity="1">600,000</text></g><g class="mark-rule role-axis-domain" pointer-events="none"><line transform="translate(0,100)" x2="0" y2="-100" stroke="#ddd" stroke-width="1" opacity="1"></line></g><g class="mark-text role-axis-title" pointer-events="none"><text text-anchor="middle" transform="translate(-67,50) rotate(-90) translate(0,-3)" font-family="var(--malloy-font-family, 'Roboto')" font-size="12px" font-weight="500" fill="var(--malloy-title-color, #505050)" opacity="1">flight_count</text></g></g><path class="foreground" aria-hidden="true" d="" pointer-events="none" display="none"></path></g></g><g class="mark-group role-scope pathgroup" role="graphics-object" aria-roledescription="group mark container"><g transform="translate(0,0)"><path class="background" aria-hidden="true" d="M0,0h150v100h-150Z"></path><g><g class="mark-line role-mark marks" role="graphics-object" aria-roledescription="line mark container"><path aria-label="month_of_year: 1; flight_count: 594779; flight_year: Jan 01, 2005" role="graphics-symbol" aria-roledescription="line mark" d="M0,8.495538461538466L13.636363636363637,16.129384615384613L27.272727272727273,5.026461538461535L40.90909090909091,8.563538461538467L54.54545454545455,5.434153846153844L68.18181818181817,6.314615384615385L81.81818181818181,3.4501538461538472L95.45454545454545,2.989846153846154L109.0909090909091,11.659692307692303L122.72727272727273,8.823076923076922L136.36363636363635,12.920923076923074L150,11.965076923076923" stroke="rgb(26, 115, 232)" stroke-width="2"></path></g></g><path class="foreground" aria-hidden="true" d="" display="none"></path></g><g transform="translate(0,0)"><path class="background" aria-hidden="true" d="M0,0h150v100h-150Z"></path><g><g class="mark-line role-mark marks" role="graphics-object" aria-roledescription="line mark container"><path aria-label="month_of_year: 1; flight_count: 583886; flight_year: Jan 01, 2004" role="graphics-symbol" aria-roledescription="line mark" d="M0,10.171384615384616L13.636363636363637,14.80538461538462L27.272727272727273,7.48184615384615L40.90909090909091,10.32153846153846L54.54545454545455,8.564153846153843L68.18181818181817,9.456307692307696L81.81818181818181,5.538615384615387L95.45454545454545,4.153230769230765L109.0909090909091,9.99723076923077L122.72727272727273,6.161384615384613L136.36363636363635,10.092L150,6.68907692307692" stroke="rgb(72, 135, 234)" stroke-width="2"></path></g></g><path class="foreground" aria-hidden="true" d="" display="none"></path></g><g transform="translate(0,0)"><path class="background" aria-hidden="true" d="M0,0h150v100h-150Z"></path><g><g class="mark-line role-mark marks" role="graphics-object" aria-roledescription="line mark container"><path aria-label="month_of_year: 1; flight_count: 555138; flight_year: Jan 01, 2003" role="graphics-symbol" aria-roledescription="line mark" d="M0,14.594153846153846L13.636363636363637,22.560307692307692L27.272727272727273,13.955384615384613L40.90909090909091,18.889538461538457L54.54545454545455,17.901230769230768L68.18181818181817,17.482461538461536L81.81818181818181,14.098461538461537L95.45454545454545,14.33184615384615L109.0909090909091,18.82369230769231L122.72727272727273,15.028307692307695L136.36363636363635,18.75030769230769L150,14.555076923076927" stroke="rgb(104, 155, 236)" stroke-width="2"></path></g></g><path class="foreground" aria-hidden="true" d="" display="none"></path></g><g transform="translate(0,0)"><path class="background" aria-hidden="true" d="M0,0h150v100h-150Z"></path><g><g class="mark-line role-mark marks" role="graphics-object" aria-roledescription="line mark container"><path aria-label="month_of_year: 1; flight_count: 487158; flight_year: Jan 01, 2001" role="graphics-symbol" aria-roledescription="line mark" d="M0,25.052615384615386L13.636363636363637,32.420153846153845L27.272727272727273,23.49723076923077L40.90909090909091,20.90107692307692L54.54545454545455,18.477538461538458L68.18181818181817,19.976000000000006L81.81818181818181,17.170923076923074L95.45454545454545,16.264923076923075L109.0909090909091,24.521538461538462L122.72727272727273,31.729538461538464L136.36363636363635,35.79461538461538L150,33.872615384615386" stroke="rgb(163, 194, 238)" stroke-width="2"></path></g></g><path class="foreground" aria-hidden="true" d="" display="none"></path></g><g transform="translate(0,0)"><path class="background" aria-hidden="true" d="M0,0h150v100h-150Z"></path><g><g class="mark-line role-mark marks" role="graphics-object" aria-roledescription="line mark container"><path aria-label="month_of_year: 1; flight_count: 470407; flight_year: Jan 01, 2000" role="graphics-symbol" aria-roledescription="line mark" d="M0,27.62969230769231L13.636363636363637,31.62338461538462L27.272727272727273,25.711230769230763L40.90909090909091,28.738615384615386L54.54545454545455,26.333076923076927L68.18181818181817,27.53676923076923L81.81818181818181,25.64938461538462L95.45454545454545,24.415692307692304L109.0909090909091,28.762L122.72727272727273,25.277384615384612L136.36363636363635,28.12707692307692L150,26.00753846153846" stroke="rgb(194, 213, 238)" stroke-width="2"></path></g></g><path class="foreground" aria-hidden="true" d="" display="none"></path></g><g transform="translate(0,0)"><path class="background" aria-hidden="true" d="M0,0h150v100h-150Z"></path><g><g class="mark-line role-mark marks" role="graphics-object" aria-roledescription="line mark container"><path aria-label="month_of_year: 1; flight_count: 436304; flight_year: Jan 01, 2002" role="graphics-symbol" aria-roledescription="line mark" d="M0,32.87630769230769L13.636363636363637,38.53753846153845L27.272727272727273,31.09938461538462L40.90909090909091,32.60738461538462L54.54545454545455,30.766000000000005L68.18181818181817,31.035999999999998L81.81818181818181,28.92307692307692L95.45454545454545,28.196461538461538L109.0909090909091,33.85153846153847L122.72727272727273,31.299076923076917L136.36363636363635,36.153230769230774L150,34.29184615384615" stroke="rgb(134, 175, 237)" stroke-width="2"></path></g></g><path class="foreground" aria-hidden="true" d="" display="none"></path></g></g><g class="mark-group role-legend" role="graphics-symbol" aria-roledescription="legend" aria-label="Gradient legend titled 'flight_year' for stroke color with values from January 01, 2000 to January 01, 2005"><g transform="translate(170,0)"><path class="background" aria-hidden="true" d="M0,0h114v117h-114Z" pointer-events="none"></path><g><g class="mark-group role-legend-entry"><g transform="translate(0,17)"><path class="background" aria-hidden="true" d="M0,0h0v0h0Z" pointer-events="none"></path><g><g class="mark-rect role-legend-gradient" pointer-events="none"><path d="M0,0h16v100h-16Z" fill="url(#gradient_27)" stroke="#ddd" stroke-width="0" opacity="1"></path></g><g class="mark-text role-legend-label" pointer-events="none"><text text-anchor="start" transform="translate(18,98)" font-family="var(--malloy-font-family, 'Roboto')" font-size="10px" fill="var(--malloy-label-color, #505050)" opacity="1">Jan 01, 2000</text><text text-anchor="start" transform="translate(18,62.98905309250138)" font-family="var(--malloy-font-family, 'Roboto')" font-size="10px" fill="var(--malloy-label-color, #505050)" opacity="1">Jan 01, 2002</text><text text-anchor="start" transform="translate(18,23.03284072249589)" font-family="var(--malloy-font-family, 'Roboto')" font-size="10px" fill="var(--malloy-label-color, #505050)" opacity="1">Jan 01, 2004</text></g></g><path class="foreground" aria-hidden="true" d="" pointer-events="none" display="none"></path></g></g><g class="mark-text role-legend-title" pointer-events="none"><text text-anchor="start" transform="translate(0,9)" font-family="var(--malloy-font-family, 'Roboto')" font-size="12px" font-weight="500" fill="var(--malloy-title-color, #505050)" opacity="1">flight_year</text></g></g><path class="foreground" aria-hidden="true" d="" pointer-events="none" display="none"></path></g></g></g><path class="foreground" aria-hidden="true" d="" display="none"></path></g></g></g><defs><linearGradient id="gradient_27" x1="0" x2="0" y1="1" y2="0"><stop offset="0" stop-color="rgb(194, 213, 238)"></stop><stop offset="0" stop-color="rgb(194, 213, 238)"></stop><stop offset="0.04980842911877394" stop-color="rgb(186, 208, 238)"></stop><stop offset="0.09961685823754789" stop-color="rgb(179, 204, 238)"></stop><stop offset="0.1499726327312534" stop-color="rgb(171, 199, 238)"></stop><stop offset="0.20032840722495895" stop-color="rgb(163, 194, 238)"></stop><stop offset="0.24958949096880131" stop-color="rgb(156, 189, 237)"></stop><stop offset="0.29939792008757526" stop-color="rgb(149, 184, 237)"></stop><stop offset="0.3497536945812808" stop-color="rgb(141, 179, 237)"></stop><stop offset="0.4001094690749863" stop-color="rgb(134, 175, 237)"></stop><stop offset="0.4493705528188287" stop-color="rgb(126, 170, 237)"></stop><stop offset="0.49917898193760263" stop-color="rgb(119, 165, 237)"></stop><stop offset="0.5495347564313081" stop-color="rgb(111, 160, 236)"></stop><stop offset="0.5998905309250137" stop-color="rgb(104, 155, 236)"></stop><stop offset="0.6491516146688561" stop-color="rgb(96, 150, 236)"></stop><stop offset="0.69896004378763" stop-color="rgb(88, 145, 235)"></stop><stop offset="0.7493158182813355" stop-color="rgb(80, 140, 235)"></stop><stop offset="0.7996715927750411" stop-color="rgb(72, 135, 234)"></stop><stop offset="0.849480021893815" stop-color="rgb(63, 130, 234)"></stop><stop offset="0.8992884510125889" stop-color="rgb(53, 125, 233)"></stop><stop offset="0.9496442255062945" stop-color="rgb(41, 120, 233)"></stop><stop offset="1" stop-color="rgb(26, 115, 232)"></stop><stop offset="1" stop-color="rgb(26, 115, 232)"></stop></linearGradient></defs></svg></div></td></tr></tbody></table>
      </div>
    </div>
    <div class="result-middle" data-result-kind="json" >
      <div class="result-inner">
        <pre><pre class="language-json" style="background-color: #FBFBFB"><span class="line"><span style="color: #000000">[</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;year_over_year&quot;</span><span style="color: #000000">: [</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;month_of_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">8</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">630566</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: {</span></span>
<span class="line"><span style="color: #000000">          </span><span style="color: #0451A5">&quot;value&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2005-01-01T00:00:00.000Z&quot;</span></span>
<span class="line"><span style="color: #000000">        }</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;month_of_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">7</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">627574</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: {</span></span>
<span class="line"><span style="color: #000000">          </span><span style="color: #0451A5">&quot;value&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2005-01-01T00:00:00.000Z&quot;</span></span>
<span class="line"><span style="color: #000000">        }</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;month_of_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">8</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">623004</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: {</span></span>
<span class="line"><span style="color: #000000">          </span><span style="color: #0451A5">&quot;value&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2004-01-01T00:00:00.000Z&quot;</span></span>
<span class="line"><span style="color: #000000">        }</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;month_of_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">3</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">617328</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: {</span></span>
<span class="line"><span style="color: #000000">          </span><span style="color: #0451A5">&quot;value&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2005-01-01T00:00:00.000Z&quot;</span></span>
<span class="line"><span style="color: #000000">        }</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;month_of_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">5</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">614678</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: {</span></span>
<span class="line"><span style="color: #000000">          </span><span style="color: #0451A5">&quot;value&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2005-01-01T00:00:00.000Z&quot;</span></span>
<span class="line"><span style="color: #000000">        }</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;month_of_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">7</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">613999</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: {</span></span>
<span class="line"><span style="color: #000000">          </span><span style="color: #0451A5">&quot;value&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2004-01-01T00:00:00.000Z&quot;</span></span>
<span class="line"><span style="color: #000000">        }</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;month_of_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">10</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">609951</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: {</span></span>
<span class="line"><span style="color: #000000">          </span><span style="color: #0451A5">&quot;value&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2004-01-01T00:00:00.000Z&quot;</span></span>
<span class="line"><span style="color: #000000">        }</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;month_of_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">6</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">608955</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: {</span></span>
<span class="line"><span style="color: #000000">          </span><span style="color: #0451A5">&quot;value&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2005-01-01T00:00:00.000Z&quot;</span></span>
<span class="line"><span style="color: #000000">        }</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;month_of_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">12</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">606521</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: {</span></span>
<span class="line"><span style="color: #000000">          </span><span style="color: #0451A5">&quot;value&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2004-01-01T00:00:00.000Z&quot;</span></span>
<span class="line"><span style="color: #000000">        }</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;month_of_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">3</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">601368</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: {</span></span>
<span class="line"><span style="color: #000000">          </span><span style="color: #0451A5">&quot;value&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2004-01-01T00:00:00.000Z&quot;</span></span>
<span class="line"><span style="color: #000000">        }</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;month_of_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">1</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">594779</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: {</span></span>
<span class="line"><span style="color: #000000">          </span><span style="color: #0451A5">&quot;value&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2005-01-01T00:00:00.000Z&quot;</span></span>
<span class="line"><span style="color: #000000">        }</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;month_of_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">4</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">594337</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: {</span></span>
<span class="line"><span style="color: #000000">          </span><span style="color: #0451A5">&quot;value&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2005-01-01T00:00:00.000Z&quot;</span></span>
<span class="line"><span style="color: #000000">        }</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;month_of_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">5</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">594333</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: {</span></span>
<span class="line"><span style="color: #000000">          </span><span style="color: #0451A5">&quot;value&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2004-01-01T00:00:00.000Z&quot;</span></span>
<span class="line"><span style="color: #000000">        }</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;month_of_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">10</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">592650</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: {</span></span>
<span class="line"><span style="color: #000000">          </span><span style="color: #0451A5">&quot;value&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2005-01-01T00:00:00.000Z&quot;</span></span>
<span class="line"><span style="color: #000000">        }</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;month_of_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">6</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">588534</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: {</span></span>
<span class="line"><span style="color: #000000">          </span><span style="color: #0451A5">&quot;value&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2004-01-01T00:00:00.000Z&quot;</span></span>
<span class="line"><span style="color: #000000">        }</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;month_of_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">9</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">585018</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: {</span></span>
<span class="line"><span style="color: #000000">          </span><span style="color: #0451A5">&quot;value&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2004-01-01T00:00:00.000Z&quot;</span></span>
<span class="line"><span style="color: #000000">        }</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;month_of_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">11</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">584402</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: {</span></span>
<span class="line"><span style="color: #000000">          </span><span style="color: #0451A5">&quot;value&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2004-01-01T00:00:00.000Z&quot;</span></span>
<span class="line"><span style="color: #000000">        }</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;month_of_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">1</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">583886</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: {</span></span>
<span class="line"><span style="color: #000000">          </span><span style="color: #0451A5">&quot;value&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2004-01-01T00:00:00.000Z&quot;</span></span>
<span class="line"><span style="color: #000000">        }</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;month_of_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">4</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">582910</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: {</span></span>
<span class="line"><span style="color: #000000">          </span><span style="color: #0451A5">&quot;value&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2004-01-01T00:00:00.000Z&quot;</span></span>
<span class="line"><span style="color: #000000">        }</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;month_of_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">9</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">574212</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: {</span></span>
<span class="line"><span style="color: #000000">          </span><span style="color: #0451A5">&quot;value&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2005-01-01T00:00:00.000Z&quot;</span></span>
<span class="line"><span style="color: #000000">        }</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;month_of_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">12</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">572227</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: {</span></span>
<span class="line"><span style="color: #000000">          </span><span style="color: #0451A5">&quot;value&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2005-01-01T00:00:00.000Z&quot;</span></span>
<span class="line"><span style="color: #000000">        }</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;month_of_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">11</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">566014</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: {</span></span>
<span class="line"><span style="color: #000000">          </span><span style="color: #0451A5">&quot;value&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2005-01-01T00:00:00.000Z&quot;</span></span>
<span class="line"><span style="color: #000000">        }</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;month_of_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">3</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">559290</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: {</span></span>
<span class="line"><span style="color: #000000">          </span><span style="color: #0451A5">&quot;value&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2003-01-01T00:00:00.000Z&quot;</span></span>
<span class="line"><span style="color: #000000">        }</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;month_of_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">7</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">558360</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: {</span></span>
<span class="line"><span style="color: #000000">          </span><span style="color: #0451A5">&quot;value&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2003-01-01T00:00:00.000Z&quot;</span></span>
<span class="line"><span style="color: #000000">        }</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;month_of_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">8</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">556843</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: {</span></span>
<span class="line"><span style="color: #000000">          </span><span style="color: #0451A5">&quot;value&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2003-01-01T00:00:00.000Z&quot;</span></span>
<span class="line"><span style="color: #000000">        }</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;month_of_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">12</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">555392</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: {</span></span>
<span class="line"><span style="color: #000000">          </span><span style="color: #0451A5">&quot;value&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2003-01-01T00:00:00.000Z&quot;</span></span>
<span class="line"><span style="color: #000000">        }</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;month_of_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">1</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">555138</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: {</span></span>
<span class="line"><span style="color: #000000">          </span><span style="color: #0451A5">&quot;value&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2003-01-01T00:00:00.000Z&quot;</span></span>
<span class="line"><span style="color: #000000">        }</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;month_of_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">2</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">553765</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: {</span></span>
<span class="line"><span style="color: #000000">          </span><span style="color: #0451A5">&quot;value&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2004-01-01T00:00:00.000Z&quot;</span></span>
<span class="line"><span style="color: #000000">        }</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;month_of_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">10</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">552316</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: {</span></span>
<span class="line"><span style="color: #000000">          </span><span style="color: #0451A5">&quot;value&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2003-01-01T00:00:00.000Z&quot;</span></span>
<span class="line"><span style="color: #000000">        }</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;month_of_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">2</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">545159</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: {</span></span>
<span class="line"><span style="color: #000000">          </span><span style="color: #0451A5">&quot;value&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2005-01-01T00:00:00.000Z&quot;</span></span>
<span class="line"><span style="color: #000000">        }</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;month_of_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">8</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">544278</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: {</span></span>
<span class="line"><span style="color: #000000">          </span><span style="color: #0451A5">&quot;value&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2001-01-01T00:00:00.000Z&quot;</span></span>
<span class="line"><span style="color: #000000">        }</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;month_of_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">7</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">538389</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: {</span></span>
<span class="line"><span style="color: #000000">          </span><span style="color: #0451A5">&quot;value&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2001-01-01T00:00:00.000Z&quot;</span></span>
<span class="line"><span style="color: #000000">        }</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;month_of_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">6</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">536364</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: {</span></span>
<span class="line"><span style="color: #000000">          </span><span style="color: #0451A5">&quot;value&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2003-01-01T00:00:00.000Z&quot;</span></span>
<span class="line"><span style="color: #000000">        }</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;month_of_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">5</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">533642</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: {</span></span>
<span class="line"><span style="color: #000000">          </span><span style="color: #0451A5">&quot;value&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2003-01-01T00:00:00.000Z&quot;</span></span>
<span class="line"><span style="color: #000000">        }</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;month_of_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">5</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">529896</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: {</span></span>
<span class="line"><span style="color: #000000">          </span><span style="color: #0451A5">&quot;value&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2001-01-01T00:00:00.000Z&quot;</span></span>
<span class="line"><span style="color: #000000">        }</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;month_of_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">11</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">528123</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: {</span></span>
<span class="line"><span style="color: #000000">          </span><span style="color: #0451A5">&quot;value&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2003-01-01T00:00:00.000Z&quot;</span></span>
<span class="line"><span style="color: #000000">        }</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;month_of_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">9</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">527646</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: {</span></span>
<span class="line"><span style="color: #000000">          </span><span style="color: #0451A5">&quot;value&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2003-01-01T00:00:00.000Z&quot;</span></span>
<span class="line"><span style="color: #000000">        }</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;month_of_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">4</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">527218</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: {</span></span>
<span class="line"><span style="color: #000000">          </span><span style="color: #0451A5">&quot;value&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2003-01-01T00:00:00.000Z&quot;</span></span>
<span class="line"><span style="color: #000000">        }</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;month_of_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">6</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">520156</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: {</span></span>
<span class="line"><span style="color: #000000">          </span><span style="color: #0451A5">&quot;value&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2001-01-01T00:00:00.000Z&quot;</span></span>
<span class="line"><span style="color: #000000">        }</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;month_of_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">4</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">514143</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: {</span></span>
<span class="line"><span style="color: #000000">          </span><span style="color: #0451A5">&quot;value&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2001-01-01T00:00:00.000Z&quot;</span></span>
<span class="line"><span style="color: #000000">        }</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;month_of_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">2</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">503358</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: {</span></span>
<span class="line"><span style="color: #000000">          </span><span style="color: #0451A5">&quot;value&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2003-01-01T00:00:00.000Z&quot;</span></span>
<span class="line"><span style="color: #000000">        }</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;month_of_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">3</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">497268</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: {</span></span>
<span class="line"><span style="color: #000000">          </span><span style="color: #0451A5">&quot;value&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2001-01-01T00:00:00.000Z&quot;</span></span>
<span class="line"><span style="color: #000000">        }</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;month_of_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">8</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">491298</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: {</span></span>
<span class="line"><span style="color: #000000">          </span><span style="color: #0451A5">&quot;value&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2000-01-01T00:00:00.000Z&quot;</span></span>
<span class="line"><span style="color: #000000">        }</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;month_of_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">9</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">490610</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: {</span></span>
<span class="line"><span style="color: #000000">          </span><span style="color: #0451A5">&quot;value&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2001-01-01T00:00:00.000Z&quot;</span></span>
<span class="line"><span style="color: #000000">        }</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;month_of_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">1</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">487158</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: {</span></span>
<span class="line"><span style="color: #000000">          </span><span style="color: #0451A5">&quot;value&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2001-01-01T00:00:00.000Z&quot;</span></span>
<span class="line"><span style="color: #000000">        }</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;month_of_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">10</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">485697</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: {</span></span>
<span class="line"><span style="color: #000000">          </span><span style="color: #0451A5">&quot;value&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2000-01-01T00:00:00.000Z&quot;</span></span>
<span class="line"><span style="color: #000000">        }</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;month_of_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">7</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">483279</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: {</span></span>
<span class="line"><span style="color: #000000">          </span><span style="color: #0451A5">&quot;value&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2000-01-01T00:00:00.000Z&quot;</span></span>
<span class="line"><span style="color: #000000">        }</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;month_of_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">3</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">482877</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: {</span></span>
<span class="line"><span style="color: #000000">          </span><span style="color: #0451A5">&quot;value&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2000-01-01T00:00:00.000Z&quot;</span></span>
<span class="line"><span style="color: #000000">        }</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;month_of_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">12</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">480951</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: {</span></span>
<span class="line"><span style="color: #000000">          </span><span style="color: #0451A5">&quot;value&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2000-01-01T00:00:00.000Z&quot;</span></span>
<span class="line"><span style="color: #000000">        }</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;month_of_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">5</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">478835</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: {</span></span>
<span class="line"><span style="color: #000000">          </span><span style="color: #0451A5">&quot;value&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2000-01-01T00:00:00.000Z&quot;</span></span>
<span class="line"><span style="color: #000000">        }</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;month_of_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">6</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">471011</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: {</span></span>
<span class="line"><span style="color: #000000">          </span><span style="color: #0451A5">&quot;value&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2000-01-01T00:00:00.000Z&quot;</span></span>
<span class="line"><span style="color: #000000">        }</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;month_of_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">1</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">470407</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: {</span></span>
<span class="line"><span style="color: #000000">          </span><span style="color: #0451A5">&quot;value&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2000-01-01T00:00:00.000Z&quot;</span></span>
<span class="line"><span style="color: #000000">        }</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;month_of_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">11</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">467174</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: {</span></span>
<span class="line"><span style="color: #000000">          </span><span style="color: #0451A5">&quot;value&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2000-01-01T00:00:00.000Z&quot;</span></span>
<span class="line"><span style="color: #000000">        }</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;month_of_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">8</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">466723</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: {</span></span>
<span class="line"><span style="color: #000000">          </span><span style="color: #0451A5">&quot;value&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2002-01-01T00:00:00.000Z&quot;</span></span>
<span class="line"><span style="color: #000000">        }</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;month_of_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">4</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">463199</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: {</span></span>
<span class="line"><span style="color: #000000">          </span><span style="color: #0451A5">&quot;value&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2000-01-01T00:00:00.000Z&quot;</span></span>
<span class="line"><span style="color: #000000">        }</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;month_of_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">9</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">463047</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: {</span></span>
<span class="line"><span style="color: #000000">          </span><span style="color: #0451A5">&quot;value&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2000-01-01T00:00:00.000Z&quot;</span></span>
<span class="line"><span style="color: #000000">        }</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;month_of_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">7</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">462000</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: {</span></span>
<span class="line"><span style="color: #000000">          </span><span style="color: #0451A5">&quot;value&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2002-01-01T00:00:00.000Z&quot;</span></span>
<span class="line"><span style="color: #000000">        }</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;month_of_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">5</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">450021</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: {</span></span>
<span class="line"><span style="color: #000000">          </span><span style="color: #0451A5">&quot;value&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2002-01-01T00:00:00.000Z&quot;</span></span>
<span class="line"><span style="color: #000000">        }</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;month_of_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">6</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">448266</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: {</span></span>
<span class="line"><span style="color: #000000">          </span><span style="color: #0451A5">&quot;value&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2002-01-01T00:00:00.000Z&quot;</span></span>
<span class="line"><span style="color: #000000">        }</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;month_of_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">3</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">447854</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: {</span></span>
<span class="line"><span style="color: #000000">          </span><span style="color: #0451A5">&quot;value&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2002-01-01T00:00:00.000Z&quot;</span></span>
<span class="line"><span style="color: #000000">        }</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;month_of_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">10</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">446556</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: {</span></span>
<span class="line"><span style="color: #000000">          </span><span style="color: #0451A5">&quot;value&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2002-01-01T00:00:00.000Z&quot;</span></span>
<span class="line"><span style="color: #000000">        }</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;month_of_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">2</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">444448</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: {</span></span>
<span class="line"><span style="color: #000000">          </span><span style="color: #0451A5">&quot;value&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2000-01-01T00:00:00.000Z&quot;</span></span>
<span class="line"><span style="color: #000000">        }</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;month_of_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">10</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">443758</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: {</span></span>
<span class="line"><span style="color: #000000">          </span><span style="color: #0451A5">&quot;value&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2001-01-01T00:00:00.000Z&quot;</span></span>
<span class="line"><span style="color: #000000">        }</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;month_of_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">2</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">439269</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: {</span></span>
<span class="line"><span style="color: #000000">          </span><span style="color: #0451A5">&quot;value&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2001-01-01T00:00:00.000Z&quot;</span></span>
<span class="line"><span style="color: #000000">        }</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;month_of_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">4</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">438052</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: {</span></span>
<span class="line"><span style="color: #000000">          </span><span style="color: #0451A5">&quot;value&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2002-01-01T00:00:00.000Z&quot;</span></span>
<span class="line"><span style="color: #000000">        }</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;month_of_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">1</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">436304</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: {</span></span>
<span class="line"><span style="color: #000000">          </span><span style="color: #0451A5">&quot;value&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2002-01-01T00:00:00.000Z&quot;</span></span>
<span class="line"><span style="color: #000000">        }</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;month_of_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">9</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">429965</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: {</span></span>
<span class="line"><span style="color: #000000">          </span><span style="color: #0451A5">&quot;value&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2002-01-01T00:00:00.000Z&quot;</span></span>
<span class="line"><span style="color: #000000">        }</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;month_of_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">12</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">429828</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: {</span></span>
<span class="line"><span style="color: #000000">          </span><span style="color: #0451A5">&quot;value&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2001-01-01T00:00:00.000Z&quot;</span></span>
<span class="line"><span style="color: #000000">        }</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;month_of_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">12</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">427103</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: {</span></span>
<span class="line"><span style="color: #000000">          </span><span style="color: #0451A5">&quot;value&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2002-01-01T00:00:00.000Z&quot;</span></span>
<span class="line"><span style="color: #000000">        }</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;month_of_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">11</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">417335</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: {</span></span>
<span class="line"><span style="color: #000000">          </span><span style="color: #0451A5">&quot;value&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2001-01-01T00:00:00.000Z&quot;</span></span>
<span class="line"><span style="color: #000000">        }</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;month_of_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">11</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">415004</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: {</span></span>
<span class="line"><span style="color: #000000">          </span><span style="color: #0451A5">&quot;value&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2002-01-01T00:00:00.000Z&quot;</span></span>
<span class="line"><span style="color: #000000">        }</span></span>
<span class="line"><span style="color: #000000">      },</span></span>
<span class="line"><span style="color: #000000">      {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;month_of_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">2</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;flight_count&quot;</span><span style="color: #000000">: </span><span style="color: #098658">399506</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">&quot;flight_year&quot;</span><span style="color: #000000">: {</span></span>
<span class="line"><span style="color: #000000">          </span><span style="color: #0451A5">&quot;value&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;2002-01-01T00:00:00.000Z&quot;</span></span>
<span class="line"><span style="color: #000000">        }</span></span>
<span class="line"><span style="color: #000000">      }</span></span>
<span class="line"><span style="color: #000000">    ]</span></span>
<span class="line"><span style="color: #000000">  }</span></span>
<span class="line"><span style="color: #000000">]</span></span></pre></pre>
      </div>
    </div>
    <div class="result-middle" data-result-kind="sql" >
      <div class="result-inner">
        <pre><pre class="language-sql" style="background-color: #FBFBFB"><span class="line"><span style="color: #0000FF">WITH</span><span style="color: #000000"> __stage0 </span><span style="color: #0000FF">AS</span><span style="color: #000000"> (</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #0000FF">SELECT</span></span>
<span class="line"><span style="color: #000000">    group_set,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0000FF">CASE</span><span style="color: #000000"> </span><span style="color: #0000FF">WHEN</span><span style="color: #000000"> group_set=</span><span style="color: #098658">1</span><span style="color: #000000"> </span><span style="color: #0000FF">THEN</span></span>
<span class="line"><span style="color: #000000">      EXTRACT(</span><span style="color: #795E26">month</span><span style="color: #000000"> </span><span style="color: #0000FF">FROM</span><span style="color: #000000"> flights.dep_time)</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #0000FF">END</span><span style="color: #000000"> </span><span style="color: #0000FF">as</span><span style="color: #000000"> month_of_year__1,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0000FF">CASE</span><span style="color: #000000"> </span><span style="color: #0000FF">WHEN</span><span style="color: #000000"> group_set=</span><span style="color: #098658">1</span><span style="color: #000000"> </span><span style="color: #0000FF">THEN</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #795E26">COUNT</span><span style="color: #000000">( </span><span style="color: #098658">1</span><span style="color: #000000">)</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #0000FF">END</span><span style="color: #000000"> </span><span style="color: #0000FF">as</span><span style="color: #000000"> flight_count__1,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0000FF">CASE</span><span style="color: #000000"> </span><span style="color: #0000FF">WHEN</span><span style="color: #000000"> group_set=</span><span style="color: #098658">1</span><span style="color: #000000"> </span><span style="color: #0000FF">THEN</span></span>
<span class="line"><span style="color: #000000">      TIMESTAMP_TRUNC(flights.dep_time,</span><span style="color: #795E26">year</span><span style="color: #000000">)</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #0000FF">END</span><span style="color: #000000"> </span><span style="color: #0000FF">as</span><span style="color: #000000"> flight_year__1</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #0000FF">FROM</span><span style="color: #000000"> </span><span style="color: #A31515">`malloy-data.faa.flights`</span><span style="color: #000000"> </span><span style="color: #0000FF">as</span><span style="color: #000000"> flights</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #0000FF">CROSS</span><span style="color: #000000"> </span><span style="color: #0000FF">JOIN</span><span style="color: #000000"> (</span><span style="color: #0000FF">SELECT</span><span style="color: #000000"> </span><span style="color: #795E26">row_number</span><span style="color: #000000">() </span><span style="color: #0000FF">OVER</span><span style="color: #000000">() -</span><span style="color: #098658">1</span><span style="color: #000000">  group_set </span><span style="color: #0000FF">FROM</span><span style="color: #000000"> UNNEST(GENERATE_ARRAY(</span><span style="color: #098658">0</span><span style="color: #000000">,</span><span style="color: #098658">1</span><span style="color: #000000">,</span><span style="color: #098658">1</span><span style="color: #000000">)))</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #0000FF">GROUP BY</span><span style="color: #000000"> </span><span style="color: #098658">1</span><span style="color: #000000">,</span><span style="color: #098658">2</span><span style="color: #000000">,</span><span style="color: #098658">4</span></span>
<span class="line"><span style="color: #000000">)</span></span>
<span class="line"><span style="color: #0000FF">SELECT</span></span>
<span class="line"><span style="color: #000000">  ARRAY_AGG(</span><span style="color: #0000FF">CASE</span><span style="color: #000000"> </span><span style="color: #0000FF">WHEN</span><span style="color: #000000"> group_set=</span><span style="color: #098658">1</span><span style="color: #000000"> </span><span style="color: #0000FF">THEN</span><span style="color: #000000"> STRUCT(</span></span>
<span class="line"><span style="color: #000000">    month_of_year__1 </span><span style="color: #0000FF">as</span><span style="color: #000000"> month_of_year, </span></span>
<span class="line"><span style="color: #000000">    flight_count__1 </span><span style="color: #0000FF">as</span><span style="color: #000000"> flight_count, </span></span>
<span class="line"><span style="color: #000000">    flight_year__1 </span><span style="color: #0000FF">as</span><span style="color: #000000"> flight_year</span></span>
<span class="line"><span style="color: #000000">    ) </span><span style="color: #0000FF">END</span><span style="color: #000000"> IGNORE NULLS  </span><span style="color: #0000FF">ORDER BY</span><span style="color: #000000">  flight_count__1 </span><span style="color: #0000FF">desc</span><span style="color: #000000"> ) </span><span style="color: #0000FF">as</span><span style="color: #000000"> year_over_year</span></span>
<span class="line"><span style="color: #0000FF">FROM</span><span style="color: #000000"> __stage0</span></span>
<span class="line"></span></pre></pre>
      </div>
    </div>
  </div>
      <h2>
        <a id="method-2-filtered-aggregates" class="header-link anchor" href="#method-2-filtered-aggregates">
          Method 2: Filtered Aggregates
        </a>
      </h2>
    <p>Filters make it easy to reuse aggregate calculations for trends analysis.</p>
<pre class="language-malloy" style="background-color: #FBFBFB"><span class="line"><span style="color: #008000">// common calculation for flights</span></span>
<span class="line"><span style="color: #AF00DB">source</span><span style="color: #000000">: </span><span style="color: #001080">flights</span><span style="color: #000000"> </span><span style="color: #AF00DB">is</span><span style="color: #000000"> </span><span style="color: #795E26">table</span><span style="color: #000000">(</span><span style="color: #A31515">&#39;malloy-data.faa.flights&#39;</span><span style="color: #000000">) {</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #AF00DB">measure</span><span style="color: #000000">: </span><span style="color: #001080">flight_count</span><span style="color: #000000"> </span><span style="color: #AF00DB">is</span><span style="color: #000000"> </span><span style="color: #795E26">count</span><span style="color: #000000">()</span></span>
<span class="line"><span style="color: #000000">}</span></span>
<span class="line"></span>
<span class="line"><span style="color: #AF00DB">query</span><span style="color: #000000">: </span><span style="color: #001080">flights</span><span style="color: #000000">-&gt;{</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #AF00DB">group_by</span><span style="color: #000000">: </span><span style="color: #001080">carrier</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #AF00DB">aggregate</span><span style="color: #000000">:</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #001080">flights_in_2002</span><span style="color: #000000"> </span><span style="color: #AF00DB">is</span><span style="color: #000000"> </span><span style="color: #001080">flight_count</span><span style="color: #000000"> { </span><span style="color: #AF00DB">where</span><span style="color: #000000">: </span><span style="color: #001080">dep_time</span><span style="color: #000000"> = </span><span style="color: #098658">@2002</span><span style="color: #000000"> }</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #001080">flights_in_2003</span><span style="color: #000000"> </span><span style="color: #AF00DB">is</span><span style="color: #000000"> </span><span style="color: #001080">flight_count</span><span style="color: #000000"> { </span><span style="color: #AF00DB">where</span><span style="color: #000000">: </span><span style="color: #001080">dep_time</span><span style="color: #000000"> = </span><span style="color: #098658">@2003</span><span style="color: #000000"> }</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #001080">percent_change</span><span style="color: #000000"> </span><span style="color: #AF00DB">is</span><span style="color: #000000"> </span><span style="color: #795E26">round</span><span style="color: #000000">(</span></span>
<span class="line"><span style="color: #000000">      (</span><span style="color: #001080">flight_count</span><span style="color: #000000"> { </span><span style="color: #AF00DB">where</span><span style="color: #000000">: </span><span style="color: #001080">dep_time</span><span style="color: #000000"> = </span><span style="color: #098658">@2003</span><span style="color: #000000"> } - </span><span style="color: #001080">flight_count</span><span style="color: #000000"> { </span><span style="color: #AF00DB">where</span><span style="color: #000000">: </span><span style="color: #001080">dep_time</span><span style="color: #000000"> = </span><span style="color: #098658">@2002</span><span style="color: #000000"> })</span></span>
<span class="line"><span style="color: #000000">        / </span><span style="color: #795E26">nullif</span><span style="color: #000000">(</span><span style="color: #001080">flight_count</span><span style="color: #000000"> { </span><span style="color: #AF00DB">where</span><span style="color: #000000">: </span><span style="color: #001080">dep_time</span><span style="color: #000000"> = </span><span style="color: #098658">@2003</span><span style="color: #000000"> }, </span><span style="color: #098658">0</span><span style="color: #000000">) * </span><span style="color: #098658">100</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #098658">1</span></span>
<span class="line"><span style="color: #000000">    )</span></span>
<span class="line"><span style="color: #000000">}</span></span></pre><div class="result-outer medium">
    <div class="result-controls-bar">
      <span class="result-label">QUERY RESULTS</span>
      <div class="result-controls">
        <button class="result-control" selected data-result-kind="html">HTML</button>
        <button class="result-control"  data-result-kind="json">JSON</button>
        <button class="result-control"  data-result-kind="sql">SQL</button>
      </div>
    </div>
    <div class="result-middle" data-result-kind="html" selected>
      <div class="result-inner">
        <table style="vertical-align: top; border-collapse: collapse; width: 100%;"><thead><tr><th style="padding: 8px; text-align: left;">carrier</th><th style="padding: 8px; text-align: right;">flights_​in_​2002</th><th style="padding: 8px; text-align: right;">flights_​in_​2003</th><th style="padding: 8px; text-align: right;">percent_​change</th></tr></thead><tbody><tr><td style="padding: 8px; vertical-align: top;"><span>WN</span></td><td style="padding: 8px; vertical-align: top; text-align: right;"><span>955,785</span></td><td style="padding: 8px; vertical-align: top; text-align: right;"><span>958,552</span></td><td style="padding: 8px; vertical-align: top; text-align: right;"><span>0.3</span></td></tr><tr><td style="padding: 8px; vertical-align: top;"><span>AA</span></td><td style="padding: 8px; vertical-align: top; text-align: right;"><span>851,499</span></td><td style="padding: 8px; vertical-align: top; text-align: right;"><span>752,197</span></td><td style="padding: 8px; vertical-align: top; text-align: right;"><span>-13.2</span></td></tr><tr><td style="padding: 8px; vertical-align: top;"><span>DL</span></td><td style="padding: 8px; vertical-align: top; text-align: right;"><span>728,659</span></td><td style="padding: 8px; vertical-align: top; text-align: right;"><span>660,598</span></td><td style="padding: 8px; vertical-align: top; text-align: right;"><span>-10.3</span></td></tr><tr><td style="padding: 8px; vertical-align: top;"><span>UA</span></td><td style="padding: 8px; vertical-align: top; text-align: right;"><span>587,848</span></td><td style="padding: 8px; vertical-align: top; text-align: right;"><span>543,930</span></td><td style="padding: 8px; vertical-align: top; text-align: right;"><span>-8.1</span></td></tr><tr><td style="padding: 8px; vertical-align: top;"><span>NW</span></td><td style="padding: 8px; vertical-align: top; text-align: right;"><span>513,325</span></td><td style="padding: 8px; vertical-align: top; text-align: right;"><span>499,153</span></td><td style="padding: 8px; vertical-align: top; text-align: right;"><span>-2.8</span></td></tr><tr><td style="padding: 8px; vertical-align: top;"><span>US</span></td><td style="padding: 8px; vertical-align: top; text-align: right;"><span>511,106</span></td><td style="padding: 8px; vertical-align: top; text-align: right;"><span>411,942</span></td><td style="padding: 8px; vertical-align: top; text-align: right;"><span>-24.1</span></td></tr><tr><td style="padding: 8px; vertical-align: top;"><span>MQ</span></td><td style="padding: 8px; vertical-align: top; text-align: right;"><span>439,056</span></td><td style="padding: 8px; vertical-align: top; text-align: right;"><span>429,092</span></td><td style="padding: 8px; vertical-align: top; text-align: right;"><span>-2.3</span></td></tr><tr><td style="padding: 8px; vertical-align: top;"><span>CO</span></td><td style="padding: 8px; vertical-align: top; text-align: right;"><span>325,014</span></td><td style="padding: 8px; vertical-align: top; text-align: right;"><span>302,741</span></td><td style="padding: 8px; vertical-align: top; text-align: right;"><span>-7.4</span></td></tr><tr><td style="padding: 8px; vertical-align: top;"><span>HP</span></td><td style="padding: 8px; vertical-align: top; text-align: right;"><span>195,870</span></td><td style="padding: 8px; vertical-align: top; text-align: right;"><span>189,325</span></td><td style="padding: 8px; vertical-align: top; text-align: right;"><span>-3.5</span></td></tr><tr><td style="padding: 8px; vertical-align: top;"><span>AS</span></td><td style="padding: 8px; vertical-align: top; text-align: right;"><span>159,192</span></td><td style="padding: 8px; vertical-align: top; text-align: right;"><span>161,592</span></td><td style="padding: 8px; vertical-align: top; text-align: right;"><span>1.5</span></td></tr><tr><td style="padding: 8px; vertical-align: top;"><span>FL</span></td><td style="padding: 8px; vertical-align: top; text-align: right;"><span>0</span></td><td style="padding: 8px; vertical-align: top; text-align: right;"><span>144,675</span></td><td style="padding: 8px; vertical-align: top; text-align: right;"><span>100</span></td></tr><tr><td style="padding: 8px; vertical-align: top;"><span>TW</span></td><td style="padding: 8px; vertical-align: top; text-align: right;"><span>0</span></td><td style="padding: 8px; vertical-align: top; text-align: right;"><span>0</span></td><td style="padding: 8px; vertical-align: top; text-align: right;"><span class="value-null">∅</span></td></tr><tr><td style="padding: 8px; vertical-align: top;"><span>AQ</span></td><td style="padding: 8px; vertical-align: top; text-align: right;"><span>0</span></td><td style="padding: 8px; vertical-align: top; text-align: right;"><span>0</span></td><td style="padding: 8px; vertical-align: top; text-align: right;"><span class="value-null">∅</span></td></tr><tr><td style="padding: 8px; vertical-align: top;"><span>EV</span></td><td style="padding: 8px; vertical-align: top; text-align: right;"><span>0</span></td><td style="padding: 8px; vertical-align: top; text-align: right;"><span>273,071</span></td><td style="padding: 8px; vertical-align: top; text-align: right;"><span>100</span></td></tr><tr><td style="padding: 8px; vertical-align: top;"><span>HA</span></td><td style="padding: 8px; vertical-align: top; text-align: right;"><span>0</span></td><td style="padding: 8px; vertical-align: top; text-align: right;"><span>7,831</span></td><td style="padding: 8px; vertical-align: top; text-align: right;"><span>100</span></td></tr><tr><td style="padding: 8px; vertical-align: top;"><span>B6</span></td><td style="padding: 8px; vertical-align: top; text-align: right;"><span>0</span></td><td style="padding: 8px; vertical-align: top; text-align: right;"><span>67,151</span></td><td style="padding: 8px; vertical-align: top; text-align: right;"><span>100</span></td></tr><tr><td style="padding: 8px; vertical-align: top;"><span>TZ</span></td><td style="padding: 8px; vertical-align: top; text-align: right;"><span>0</span></td><td style="padding: 8px; vertical-align: top; text-align: right;"><span>69,159</span></td><td style="padding: 8px; vertical-align: top; text-align: right;"><span>100</span></td></tr><tr><td style="padding: 8px; vertical-align: top;"><span>DH</span></td><td style="padding: 8px; vertical-align: top; text-align: right;"><span>0</span></td><td style="padding: 8px; vertical-align: top; text-align: right;"><span>291,581</span></td><td style="padding: 8px; vertical-align: top; text-align: right;"><span>100</span></td></tr><tr><td style="padding: 8px; vertical-align: top;"><span>RU</span></td><td style="padding: 8px; vertical-align: top; text-align: right;"><span>0</span></td><td style="padding: 8px; vertical-align: top; text-align: right;"><span>328,086</span></td><td style="padding: 8px; vertical-align: top; text-align: right;"><span>100</span></td></tr><tr><td style="padding: 8px; vertical-align: top;"><span>F9</span></td><td style="padding: 8px; vertical-align: top; text-align: right;"><span>0</span></td><td style="padding: 8px; vertical-align: top; text-align: right;"><span>0</span></td><td style="padding: 8px; vertical-align: top; text-align: right;"><span class="value-null">∅</span></td></tr><tr><td style="padding: 8px; vertical-align: top;"><span>OO</span></td><td style="padding: 8px; vertical-align: top; text-align: right;"><span>0</span></td><td style="padding: 8px; vertical-align: top; text-align: right;"><span>403,014</span></td><td style="padding: 8px; vertical-align: top; text-align: right;"><span>100</span></td></tr><tr><td style="padding: 8px; vertical-align: top;"><span>OH</span></td><td style="padding: 8px; vertical-align: top; text-align: right;"><span>0</span></td><td style="padding: 8px; vertical-align: top; text-align: right;"><span>0</span></td><td style="padding: 8px; vertical-align: top; text-align: right;"><span class="value-null">∅</span></td></tr></tbody></table>
      </div>
    </div>
    <div class="result-middle" data-result-kind="json" >
      <div class="result-inner">
        <pre><pre class="language-json" style="background-color: #FBFBFB"><span class="line"><span style="color: #000000">[</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;carrier&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;WN&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flights_in_2002&quot;</span><span style="color: #000000">: </span><span style="color: #098658">955785</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flights_in_2003&quot;</span><span style="color: #000000">: </span><span style="color: #098658">958552</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;percent_change&quot;</span><span style="color: #000000">: </span><span style="color: #098658">0.3</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;carrier&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;AA&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flights_in_2002&quot;</span><span style="color: #000000">: </span><span style="color: #098658">851499</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flights_in_2003&quot;</span><span style="color: #000000">: </span><span style="color: #098658">752197</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;percent_change&quot;</span><span style="color: #000000">: </span><span style="color: #098658">-13.2</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;carrier&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;DL&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flights_in_2002&quot;</span><span style="color: #000000">: </span><span style="color: #098658">728659</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flights_in_2003&quot;</span><span style="color: #000000">: </span><span style="color: #098658">660598</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;percent_change&quot;</span><span style="color: #000000">: </span><span style="color: #098658">-10.3</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;carrier&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;UA&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flights_in_2002&quot;</span><span style="color: #000000">: </span><span style="color: #098658">587848</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flights_in_2003&quot;</span><span style="color: #000000">: </span><span style="color: #098658">543930</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;percent_change&quot;</span><span style="color: #000000">: </span><span style="color: #098658">-8.1</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;carrier&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;NW&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flights_in_2002&quot;</span><span style="color: #000000">: </span><span style="color: #098658">513325</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flights_in_2003&quot;</span><span style="color: #000000">: </span><span style="color: #098658">499153</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;percent_change&quot;</span><span style="color: #000000">: </span><span style="color: #098658">-2.8</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;carrier&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;US&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flights_in_2002&quot;</span><span style="color: #000000">: </span><span style="color: #098658">511106</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flights_in_2003&quot;</span><span style="color: #000000">: </span><span style="color: #098658">411942</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;percent_change&quot;</span><span style="color: #000000">: </span><span style="color: #098658">-24.1</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;carrier&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;MQ&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flights_in_2002&quot;</span><span style="color: #000000">: </span><span style="color: #098658">439056</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flights_in_2003&quot;</span><span style="color: #000000">: </span><span style="color: #098658">429092</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;percent_change&quot;</span><span style="color: #000000">: </span><span style="color: #098658">-2.3</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;carrier&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;CO&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flights_in_2002&quot;</span><span style="color: #000000">: </span><span style="color: #098658">325014</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flights_in_2003&quot;</span><span style="color: #000000">: </span><span style="color: #098658">302741</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;percent_change&quot;</span><span style="color: #000000">: </span><span style="color: #098658">-7.4</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;carrier&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;HP&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flights_in_2002&quot;</span><span style="color: #000000">: </span><span style="color: #098658">195870</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flights_in_2003&quot;</span><span style="color: #000000">: </span><span style="color: #098658">189325</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;percent_change&quot;</span><span style="color: #000000">: </span><span style="color: #098658">-3.5</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;carrier&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;AS&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flights_in_2002&quot;</span><span style="color: #000000">: </span><span style="color: #098658">159192</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flights_in_2003&quot;</span><span style="color: #000000">: </span><span style="color: #098658">161592</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;percent_change&quot;</span><span style="color: #000000">: </span><span style="color: #098658">1.5</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;carrier&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;FL&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flights_in_2002&quot;</span><span style="color: #000000">: </span><span style="color: #098658">0</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flights_in_2003&quot;</span><span style="color: #000000">: </span><span style="color: #098658">144675</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;percent_change&quot;</span><span style="color: #000000">: </span><span style="color: #098658">100</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;carrier&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;TW&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flights_in_2002&quot;</span><span style="color: #000000">: </span><span style="color: #098658">0</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flights_in_2003&quot;</span><span style="color: #000000">: </span><span style="color: #098658">0</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;percent_change&quot;</span><span style="color: #000000">: </span><span style="color: #0000FF">null</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;carrier&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;AQ&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flights_in_2002&quot;</span><span style="color: #000000">: </span><span style="color: #098658">0</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flights_in_2003&quot;</span><span style="color: #000000">: </span><span style="color: #098658">0</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;percent_change&quot;</span><span style="color: #000000">: </span><span style="color: #0000FF">null</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;carrier&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;EV&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flights_in_2002&quot;</span><span style="color: #000000">: </span><span style="color: #098658">0</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flights_in_2003&quot;</span><span style="color: #000000">: </span><span style="color: #098658">273071</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;percent_change&quot;</span><span style="color: #000000">: </span><span style="color: #098658">100</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;carrier&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;HA&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flights_in_2002&quot;</span><span style="color: #000000">: </span><span style="color: #098658">0</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flights_in_2003&quot;</span><span style="color: #000000">: </span><span style="color: #098658">7831</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;percent_change&quot;</span><span style="color: #000000">: </span><span style="color: #098658">100</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;carrier&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;B6&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flights_in_2002&quot;</span><span style="color: #000000">: </span><span style="color: #098658">0</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flights_in_2003&quot;</span><span style="color: #000000">: </span><span style="color: #098658">67151</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;percent_change&quot;</span><span style="color: #000000">: </span><span style="color: #098658">100</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;carrier&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;TZ&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flights_in_2002&quot;</span><span style="color: #000000">: </span><span style="color: #098658">0</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flights_in_2003&quot;</span><span style="color: #000000">: </span><span style="color: #098658">69159</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;percent_change&quot;</span><span style="color: #000000">: </span><span style="color: #098658">100</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;carrier&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;DH&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flights_in_2002&quot;</span><span style="color: #000000">: </span><span style="color: #098658">0</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flights_in_2003&quot;</span><span style="color: #000000">: </span><span style="color: #098658">291581</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;percent_change&quot;</span><span style="color: #000000">: </span><span style="color: #098658">100</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;carrier&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;RU&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flights_in_2002&quot;</span><span style="color: #000000">: </span><span style="color: #098658">0</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flights_in_2003&quot;</span><span style="color: #000000">: </span><span style="color: #098658">328086</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;percent_change&quot;</span><span style="color: #000000">: </span><span style="color: #098658">100</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;carrier&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;F9&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flights_in_2002&quot;</span><span style="color: #000000">: </span><span style="color: #098658">0</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flights_in_2003&quot;</span><span style="color: #000000">: </span><span style="color: #098658">0</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;percent_change&quot;</span><span style="color: #000000">: </span><span style="color: #0000FF">null</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;carrier&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;OO&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flights_in_2002&quot;</span><span style="color: #000000">: </span><span style="color: #098658">0</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flights_in_2003&quot;</span><span style="color: #000000">: </span><span style="color: #098658">403014</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;percent_change&quot;</span><span style="color: #000000">: </span><span style="color: #098658">100</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;carrier&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;OH&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flights_in_2002&quot;</span><span style="color: #000000">: </span><span style="color: #098658">0</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;flights_in_2003&quot;</span><span style="color: #000000">: </span><span style="color: #098658">0</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;percent_change&quot;</span><span style="color: #000000">: </span><span style="color: #0000FF">null</span></span>
<span class="line"><span style="color: #000000">  }</span></span>
<span class="line"><span style="color: #000000">]</span></span></pre></pre>
      </div>
    </div>
    <div class="result-middle" data-result-kind="sql" >
      <div class="result-inner">
        <pre><pre class="language-sql" style="background-color: #FBFBFB"><span class="line"><span style="color: #0000FF">SELECT</span><span style="color: #000000"> </span></span>
<span class="line"><span style="color: #000000">   flights.carrier </span><span style="color: #0000FF">as</span><span style="color: #000000"> carrier,</span></span>
<span class="line"><span style="color: #000000">   (</span><span style="color: #795E26">COUNT</span><span style="color: #000000">( </span><span style="color: #0000FF">CASE</span><span style="color: #000000"> </span><span style="color: #0000FF">WHEN</span><span style="color: #000000"> (flights.dep_time&gt;=</span><span style="color: #0000FF">TIMESTAMP</span><span style="color: #000000">(</span><span style="color: #A31515">&#39;2002-01-01&#39;</span><span style="color: #000000">, </span><span style="color: #A31515">&#39;UTC&#39;</span><span style="color: #000000">))</span><span style="color: #0000FF">and</span><span style="color: #000000">(flights.dep_time&lt;</span><span style="color: #0000FF">TIMESTAMP</span><span style="color: #000000">(</span><span style="color: #A31515">&#39;2003-01-01&#39;</span><span style="color: #000000">, </span><span style="color: #A31515">&#39;UTC&#39;</span><span style="color: #000000">)) </span><span style="color: #0000FF">THEN</span><span style="color: #000000"> </span><span style="color: #098658">1</span><span style="color: #000000"> </span><span style="color: #0000FF">END</span><span style="color: #000000">)) </span><span style="color: #0000FF">as</span><span style="color: #000000"> flights_in_2002,</span></span>
<span class="line"><span style="color: #000000">   (</span><span style="color: #795E26">COUNT</span><span style="color: #000000">( </span><span style="color: #0000FF">CASE</span><span style="color: #000000"> </span><span style="color: #0000FF">WHEN</span><span style="color: #000000"> (flights.dep_time&gt;=</span><span style="color: #0000FF">TIMESTAMP</span><span style="color: #000000">(</span><span style="color: #A31515">&#39;2003-01-01&#39;</span><span style="color: #000000">, </span><span style="color: #A31515">&#39;UTC&#39;</span><span style="color: #000000">))</span><span style="color: #0000FF">and</span><span style="color: #000000">(flights.dep_time&lt;</span><span style="color: #0000FF">TIMESTAMP</span><span style="color: #000000">(</span><span style="color: #A31515">&#39;2004-01-01&#39;</span><span style="color: #000000">, </span><span style="color: #A31515">&#39;UTC&#39;</span><span style="color: #000000">)) </span><span style="color: #0000FF">THEN</span><span style="color: #000000"> </span><span style="color: #098658">1</span><span style="color: #000000"> </span><span style="color: #0000FF">END</span><span style="color: #000000">)) </span><span style="color: #0000FF">as</span><span style="color: #000000"> flights_in_2003,</span></span>
<span class="line"><span style="color: #000000">   </span><span style="color: #795E26">round</span><span style="color: #000000">(((((</span><span style="color: #795E26">COUNT</span><span style="color: #000000">( </span><span style="color: #0000FF">CASE</span><span style="color: #000000"> </span><span style="color: #0000FF">WHEN</span><span style="color: #000000"> (flights.dep_time&gt;=</span><span style="color: #0000FF">TIMESTAMP</span><span style="color: #000000">(</span><span style="color: #A31515">&#39;2003-01-01&#39;</span><span style="color: #000000">, </span><span style="color: #A31515">&#39;UTC&#39;</span><span style="color: #000000">))</span><span style="color: #0000FF">and</span><span style="color: #000000">(flights.dep_time&lt;</span><span style="color: #0000FF">TIMESTAMP</span><span style="color: #000000">(</span><span style="color: #A31515">&#39;2004-01-01&#39;</span><span style="color: #000000">, </span><span style="color: #A31515">&#39;UTC&#39;</span><span style="color: #000000">)) </span><span style="color: #0000FF">THEN</span><span style="color: #000000"> </span><span style="color: #098658">1</span><span style="color: #000000"> </span><span style="color: #0000FF">END</span><span style="color: #000000">))-(</span><span style="color: #795E26">COUNT</span><span style="color: #000000">( </span><span style="color: #0000FF">CASE</span><span style="color: #000000"> </span><span style="color: #0000FF">WHEN</span><span style="color: #000000"> (flights.dep_time&gt;=</span><span style="color: #0000FF">TIMESTAMP</span><span style="color: #000000">(</span><span style="color: #A31515">&#39;2002-01-01&#39;</span><span style="color: #000000">, </span><span style="color: #A31515">&#39;UTC&#39;</span><span style="color: #000000">))</span><span style="color: #0000FF">and</span><span style="color: #000000">(flights.dep_time&lt;</span><span style="color: #0000FF">TIMESTAMP</span><span style="color: #000000">(</span><span style="color: #A31515">&#39;2003-01-01&#39;</span><span style="color: #000000">, </span><span style="color: #A31515">&#39;UTC&#39;</span><span style="color: #000000">)) </span><span style="color: #0000FF">THEN</span><span style="color: #000000"> </span><span style="color: #098658">1</span><span style="color: #000000"> </span><span style="color: #0000FF">END</span><span style="color: #000000">))))/(</span><span style="color: #795E26">nullif</span><span style="color: #000000">((</span><span style="color: #795E26">COUNT</span><span style="color: #000000">( </span><span style="color: #0000FF">CASE</span><span style="color: #000000"> </span><span style="color: #0000FF">WHEN</span><span style="color: #000000"> (flights.dep_time&gt;=</span><span style="color: #0000FF">TIMESTAMP</span><span style="color: #000000">(</span><span style="color: #A31515">&#39;2003-01-01&#39;</span><span style="color: #000000">, </span><span style="color: #A31515">&#39;UTC&#39;</span><span style="color: #000000">))</span><span style="color: #0000FF">and</span><span style="color: #000000">(flights.dep_time&lt;</span><span style="color: #0000FF">TIMESTAMP</span><span style="color: #000000">(</span><span style="color: #A31515">&#39;2004-01-01&#39;</span><span style="color: #000000">, </span><span style="color: #A31515">&#39;UTC&#39;</span><span style="color: #000000">)) </span><span style="color: #0000FF">THEN</span><span style="color: #000000"> </span><span style="color: #098658">1</span><span style="color: #000000"> </span><span style="color: #0000FF">END</span><span style="color: #000000">)),</span><span style="color: #098658">0</span><span style="color: #000000">)))*</span><span style="color: #098658">100</span><span style="color: #000000">,</span><span style="color: #098658">1</span><span style="color: #000000">) </span><span style="color: #0000FF">as</span><span style="color: #000000"> percent_change</span></span>
<span class="line"><span style="color: #0000FF">FROM</span><span style="color: #000000"> </span><span style="color: #A31515">`malloy-data.faa.flights`</span><span style="color: #000000"> </span><span style="color: #0000FF">as</span><span style="color: #000000"> flights</span></span>
<span class="line"><span style="color: #0000FF">GROUP BY</span><span style="color: #000000"> </span><span style="color: #098658">1</span></span>
<span class="line"><span style="color: #0000FF">ORDER BY</span><span style="color: #000000"> </span><span style="color: #098658">2</span><span style="color: #000000"> </span><span style="color: #0000FF">desc</span></span>
<span class="line"></span></pre></pre>
      </div>
    </div>
  </div>
      <h3>
        <a id="using-relative-timeframes" class="header-link anchor" href="#using-relative-timeframes">
          Using Relative Timeframes
        </a>
      </h3>
    <p>Often you want to show up-to-date information.  You can write timeframes relatively so the queries always show
current data.  Read more about it in the <a href="filter_expressions.html">filters</a> section.</p>
<pre class="language-malloy" style="background-color: #FBFBFB"><span class="line"><span style="color: #AF00DB">source</span><span style="color: #000000">: </span><span style="color: #001080">inventory_items</span><span style="color: #000000"> </span><span style="color: #AF00DB">is</span><span style="color: #000000"> </span><span style="color: #795E26">table</span><span style="color: #000000">(</span><span style="color: #A31515">&#39;malloy-data.ecomm.inventory_items&#39;</span><span style="color: #000000">) {</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #AF00DB">primary_key</span><span style="color: #000000">: </span><span style="color: #001080">id</span></span>
<span class="line"><span style="color: #000000">}</span></span>
<span class="line"></span>
<span class="line"><span style="color: #AF00DB">source</span><span style="color: #000000">: </span><span style="color: #001080">order_items</span><span style="color: #000000"> </span><span style="color: #AF00DB">is</span><span style="color: #000000"> </span><span style="color: #795E26">table</span><span style="color: #000000">(</span><span style="color: #A31515">&#39;malloy-data.ecomm.order_items&#39;</span><span style="color: #000000">) {</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #AF00DB">join_one</span><span style="color: #000000">: </span><span style="color: #001080">inventory_items</span><span style="color: #000000"> </span><span style="color: #AF00DB">with</span><span style="color: #000000"> </span><span style="color: #001080">inventory_item_id</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #AF00DB">measure</span><span style="color: #000000">: </span><span style="color: #001080">order_item_count</span><span style="color: #000000"> </span><span style="color: #AF00DB">is</span><span style="color: #000000"> </span><span style="color: #795E26">count</span><span style="color: #000000">()</span></span>
<span class="line"><span style="color: #000000">}</span></span>
<span class="line"></span>
<span class="line"><span style="color: #AF00DB">query</span><span style="color: #000000">: </span><span style="color: #001080">order_items</span><span style="color: #000000"> -&gt; {</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #AF00DB">top</span><span style="color: #000000">: </span><span style="color: #098658">10</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #AF00DB">group_by</span><span style="color: #000000">: </span><span style="color: #001080">inventory_items</span><span style="color: #000000">.</span><span style="color: #001080">product_category</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #AF00DB">aggregate</span><span style="color: #000000">:</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #001080">last_year</span><span style="color: #000000"> </span><span style="color: #AF00DB">is</span><span style="color: #000000"> </span><span style="color: #001080">order_item_count</span><span style="color: #000000"> { </span><span style="color: #AF00DB">where</span><span style="color: #000000">: </span><span style="color: #001080">created_at</span><span style="color: #000000"> ? </span><span style="color: #001080">now</span><span style="color: #000000">.</span><span style="color: #0000FF">year</span><span style="color: #000000"> - </span><span style="color: #098658">1</span><span style="color: #000000"> </span><span style="color: #0000FF">year</span><span style="color: #000000"> }</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #001080">prior_year</span><span style="color: #000000"> </span><span style="color: #AF00DB">is</span><span style="color: #000000"> </span><span style="color: #001080">order_item_count</span><span style="color: #000000"> { </span><span style="color: #AF00DB">where</span><span style="color: #000000">: </span><span style="color: #001080">created_at</span><span style="color: #000000"> ? </span><span style="color: #001080">now</span><span style="color: #000000">.</span><span style="color: #0000FF">year</span><span style="color: #000000"> - </span><span style="color: #098658">2</span><span style="color: #000000"> </span><span style="color: #0000FF">years</span><span style="color: #000000"> }</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #001080">percent_change</span><span style="color: #000000"> </span><span style="color: #AF00DB">is</span><span style="color: #000000"> </span><span style="color: #795E26">round</span><span style="color: #000000">(</span></span>
<span class="line"><span style="color: #000000">      (</span><span style="color: #001080">order_item_count</span><span style="color: #000000"> { </span><span style="color: #AF00DB">where</span><span style="color: #000000">: </span><span style="color: #001080">created_at</span><span style="color: #000000"> ? </span><span style="color: #001080">now</span><span style="color: #000000">.</span><span style="color: #0000FF">year</span><span style="color: #000000"> - </span><span style="color: #098658">1</span><span style="color: #000000"> </span><span style="color: #0000FF">year</span><span style="color: #000000"> } - </span><span style="color: #001080">order_item_count</span><span style="color: #000000"> { </span><span style="color: #AF00DB">where</span><span style="color: #000000">: </span><span style="color: #001080">created_at</span><span style="color: #000000"> ? </span><span style="color: #001080">now</span><span style="color: #000000">.</span><span style="color: #0000FF">year</span><span style="color: #000000"> - </span><span style="color: #098658">2</span><span style="color: #000000"> </span><span style="color: #0000FF">years</span><span style="color: #000000"> })</span></span>
<span class="line"><span style="color: #000000">        / </span><span style="color: #795E26">nullif</span><span style="color: #000000">(</span><span style="color: #001080">order_item_count</span><span style="color: #000000"> { </span><span style="color: #AF00DB">where</span><span style="color: #000000">: </span><span style="color: #001080">created_at</span><span style="color: #000000">  ? </span><span style="color: #001080">now</span><span style="color: #000000">.</span><span style="color: #0000FF">year</span><span style="color: #000000"> - </span><span style="color: #098658">2</span><span style="color: #000000"> </span><span style="color: #0000FF">years</span><span style="color: #000000"> }, </span><span style="color: #098658">0</span><span style="color: #000000">) * </span><span style="color: #098658">100</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #098658">1</span></span>
<span class="line"><span style="color: #000000">    )</span></span>
<span class="line"><span style="color: #000000">}</span></span></pre><div class="result-outer medium">
    <div class="result-controls-bar">
      <span class="result-label">QUERY RESULTS</span>
      <div class="result-controls">
        <button class="result-control" selected data-result-kind="html">HTML</button>
        <button class="result-control"  data-result-kind="json">JSON</button>
        <button class="result-control"  data-result-kind="sql">SQL</button>
      </div>
    </div>
    <div class="result-middle" data-result-kind="html" selected>
      <div class="result-inner">
        <table style="vertical-align: top; border-collapse: collapse; width: 100%;"><thead><tr><th style="padding: 8px; text-align: left;">product_​category</th><th style="padding: 8px; text-align: right;">last_​year</th><th style="padding: 8px; text-align: right;">prior_​year</th><th style="padding: 8px; text-align: right;">percent_​change</th></tr></thead><tbody><tr><td style="padding: 8px; vertical-align: top;"><span>Accessories</span></td><td style="padding: 8px; vertical-align: top; text-align: right;"><span>10,380</span></td><td style="padding: 8px; vertical-align: top; text-align: right;"><span>6,857</span></td><td style="padding: 8px; vertical-align: top; text-align: right;"><span>51.4</span></td></tr><tr><td style="padding: 8px; vertical-align: top;"><span>Jeans</span></td><td style="padding: 8px; vertical-align: top; text-align: right;"><span>9,756</span></td><td style="padding: 8px; vertical-align: top; text-align: right;"><span>6,639</span></td><td style="padding: 8px; vertical-align: top; text-align: right;"><span>46.9</span></td></tr><tr><td style="padding: 8px; vertical-align: top;"><span>Tops &amp; Tees</span></td><td style="padding: 8px; vertical-align: top; text-align: right;"><span>8,448</span></td><td style="padding: 8px; vertical-align: top; text-align: right;"><span>5,561</span></td><td style="padding: 8px; vertical-align: top; text-align: right;"><span>51.9</span></td></tr><tr><td style="padding: 8px; vertical-align: top;"><span>Active</span></td><td style="padding: 8px; vertical-align: top; text-align: right;"><span>7,164</span></td><td style="padding: 8px; vertical-align: top; text-align: right;"><span>4,934</span></td><td style="padding: 8px; vertical-align: top; text-align: right;"><span>45.2</span></td></tr><tr><td style="padding: 8px; vertical-align: top;"><span>Shorts</span></td><td style="padding: 8px; vertical-align: top; text-align: right;"><span>6,311</span></td><td style="padding: 8px; vertical-align: top; text-align: right;"><span>4,211</span></td><td style="padding: 8px; vertical-align: top; text-align: right;"><span>49.9</span></td></tr><tr><td style="padding: 8px; vertical-align: top;"><span>Pants</span></td><td style="padding: 8px; vertical-align: top; text-align: right;"><span>4,750</span></td><td style="padding: 8px; vertical-align: top; text-align: right;"><span>3,213</span></td><td style="padding: 8px; vertical-align: top; text-align: right;"><span>47.8</span></td></tr><tr><td style="padding: 8px; vertical-align: top;"><span>Outerwear &amp; Coats</span></td><td style="padding: 8px; vertical-align: top; text-align: right;"><span>4,073</span></td><td style="padding: 8px; vertical-align: top; text-align: right;"><span>2,832</span></td><td style="padding: 8px; vertical-align: top; text-align: right;"><span>43.8</span></td></tr><tr><td style="padding: 8px; vertical-align: top;"><span>Fashion Hoodies &amp; Sweatshirts</span></td><td style="padding: 8px; vertical-align: top; text-align: right;"><span>4,057</span></td><td style="padding: 8px; vertical-align: top; text-align: right;"><span>2,604</span></td><td style="padding: 8px; vertical-align: top; text-align: right;"><span>55.8</span></td></tr><tr><td style="padding: 8px; vertical-align: top;"><span>Dresses</span></td><td style="padding: 8px; vertical-align: top; text-align: right;"><span>3,809</span></td><td style="padding: 8px; vertical-align: top; text-align: right;"><span>2,436</span></td><td style="padding: 8px; vertical-align: top; text-align: right;"><span>56.4</span></td></tr><tr><td style="padding: 8px; vertical-align: top;"><span>Sweaters</span></td><td style="padding: 8px; vertical-align: top; text-align: right;"><span>3,489</span></td><td style="padding: 8px; vertical-align: top; text-align: right;"><span>2,339</span></td><td style="padding: 8px; vertical-align: top; text-align: right;"><span>49.2</span></td></tr></tbody></table>
      </div>
    </div>
    <div class="result-middle" data-result-kind="json" >
      <div class="result-inner">
        <pre><pre class="language-json" style="background-color: #FBFBFB"><span class="line"><span style="color: #000000">[</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;product_category&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;Accessories&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;last_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">10380</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;prior_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">6857</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;percent_change&quot;</span><span style="color: #000000">: </span><span style="color: #098658">51.4</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;product_category&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;Jeans&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;last_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">9756</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;prior_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">6639</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;percent_change&quot;</span><span style="color: #000000">: </span><span style="color: #098658">46.9</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;product_category&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;Tops &amp; Tees&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;last_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">8448</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;prior_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">5561</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;percent_change&quot;</span><span style="color: #000000">: </span><span style="color: #098658">51.9</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;product_category&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;Active&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;last_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">7164</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;prior_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">4934</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;percent_change&quot;</span><span style="color: #000000">: </span><span style="color: #098658">45.2</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;product_category&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;Shorts&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;last_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">6311</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;prior_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">4211</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;percent_change&quot;</span><span style="color: #000000">: </span><span style="color: #098658">49.9</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;product_category&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;Pants&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;last_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">4750</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;prior_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">3213</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;percent_change&quot;</span><span style="color: #000000">: </span><span style="color: #098658">47.8</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;product_category&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;Outerwear &amp; Coats&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;last_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">4073</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;prior_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">2832</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;percent_change&quot;</span><span style="color: #000000">: </span><span style="color: #098658">43.8</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;product_category&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;Fashion Hoodies &amp; Sweatshirts&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;last_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">4057</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;prior_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">2604</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;percent_change&quot;</span><span style="color: #000000">: </span><span style="color: #098658">55.8</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;product_category&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;Dresses&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;last_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">3809</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;prior_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">2436</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;percent_change&quot;</span><span style="color: #000000">: </span><span style="color: #098658">56.4</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;product_category&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;Sweaters&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;last_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">3489</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;prior_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">2339</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;percent_change&quot;</span><span style="color: #000000">: </span><span style="color: #098658">49.2</span></span>
<span class="line"><span style="color: #000000">  }</span></span>
<span class="line"><span style="color: #000000">]</span></span></pre></pre>
      </div>
    </div>
    <div class="result-middle" data-result-kind="sql" >
      <div class="result-inner">
        <pre><pre class="language-sql" style="background-color: #FBFBFB"><span class="line"><span style="color: #0000FF">SELECT</span><span style="color: #000000"> </span></span>
<span class="line"><span style="color: #000000">   inventory_items_0.product_category </span><span style="color: #0000FF">as</span><span style="color: #000000"> product_category,</span></span>
<span class="line"><span style="color: #000000">   (</span><span style="color: #795E26">COUNT</span><span style="color: #000000">( </span><span style="color: #0000FF">CASE</span><span style="color: #000000"> </span><span style="color: #0000FF">WHEN</span><span style="color: #000000"> (order_items.created_at&gt;=</span><span style="color: #0000FF">TIMESTAMP</span><span style="color: #000000">(DATETIME_SUB(</span><span style="color: #0000FF">DATETIME</span><span style="color: #000000">(TIMESTAMP_TRUNC(</span><span style="color: #795E26">CURRENT_TIMESTAMP</span><span style="color: #000000">(),</span><span style="color: #795E26">year</span><span style="color: #000000">)), INTERVAL </span><span style="color: #098658">1</span><span style="color: #000000"> </span><span style="color: #795E26">year</span><span style="color: #000000">)))</span><span style="color: #0000FF">and</span><span style="color: #000000">(order_items.created_at&lt;</span><span style="color: #0000FF">TIMESTAMP</span><span style="color: #000000">(DATETIME_ADD(</span><span style="color: #0000FF">DATETIME</span><span style="color: #000000">(</span><span style="color: #0000FF">TIMESTAMP</span><span style="color: #000000">(DATETIME_SUB(</span><span style="color: #0000FF">DATETIME</span><span style="color: #000000">(TIMESTAMP_TRUNC(</span><span style="color: #795E26">CURRENT_TIMESTAMP</span><span style="color: #000000">(),</span><span style="color: #795E26">year</span><span style="color: #000000">)), INTERVAL </span><span style="color: #098658">1</span><span style="color: #000000"> </span><span style="color: #795E26">year</span><span style="color: #000000">))), INTERVAL </span><span style="color: #098658">1</span><span style="color: #000000"> </span><span style="color: #795E26">year</span><span style="color: #000000">))) </span><span style="color: #0000FF">THEN</span><span style="color: #000000"> </span><span style="color: #098658">1</span><span style="color: #000000"> </span><span style="color: #0000FF">END</span><span style="color: #000000">)) </span><span style="color: #0000FF">as</span><span style="color: #000000"> last_year,</span></span>
<span class="line"><span style="color: #000000">   (</span><span style="color: #795E26">COUNT</span><span style="color: #000000">( </span><span style="color: #0000FF">CASE</span><span style="color: #000000"> </span><span style="color: #0000FF">WHEN</span><span style="color: #000000"> (order_items.created_at&gt;=</span><span style="color: #0000FF">TIMESTAMP</span><span style="color: #000000">(DATETIME_SUB(</span><span style="color: #0000FF">DATETIME</span><span style="color: #000000">(TIMESTAMP_TRUNC(</span><span style="color: #795E26">CURRENT_TIMESTAMP</span><span style="color: #000000">(),</span><span style="color: #795E26">year</span><span style="color: #000000">)), INTERVAL </span><span style="color: #098658">2</span><span style="color: #000000"> </span><span style="color: #795E26">year</span><span style="color: #000000">)))</span><span style="color: #0000FF">and</span><span style="color: #000000">(order_items.created_at&lt;</span><span style="color: #0000FF">TIMESTAMP</span><span style="color: #000000">(DATETIME_ADD(</span><span style="color: #0000FF">DATETIME</span><span style="color: #000000">(</span><span style="color: #0000FF">TIMESTAMP</span><span style="color: #000000">(DATETIME_SUB(</span><span style="color: #0000FF">DATETIME</span><span style="color: #000000">(TIMESTAMP_TRUNC(</span><span style="color: #795E26">CURRENT_TIMESTAMP</span><span style="color: #000000">(),</span><span style="color: #795E26">year</span><span style="color: #000000">)), INTERVAL </span><span style="color: #098658">2</span><span style="color: #000000"> </span><span style="color: #795E26">year</span><span style="color: #000000">))), INTERVAL </span><span style="color: #098658">1</span><span style="color: #000000"> </span><span style="color: #795E26">year</span><span style="color: #000000">))) </span><span style="color: #0000FF">THEN</span><span style="color: #000000"> </span><span style="color: #098658">1</span><span style="color: #000000"> </span><span style="color: #0000FF">END</span><span style="color: #000000">)) </span><span style="color: #0000FF">as</span><span style="color: #000000"> prior_year,</span></span>
<span class="line"><span style="color: #000000">   </span><span style="color: #795E26">round</span><span style="color: #000000">(((((</span><span style="color: #795E26">COUNT</span><span style="color: #000000">( </span><span style="color: #0000FF">CASE</span><span style="color: #000000"> </span><span style="color: #0000FF">WHEN</span><span style="color: #000000"> (order_items.created_at&gt;=</span><span style="color: #0000FF">TIMESTAMP</span><span style="color: #000000">(DATETIME_SUB(</span><span style="color: #0000FF">DATETIME</span><span style="color: #000000">(TIMESTAMP_TRUNC(</span><span style="color: #795E26">CURRENT_TIMESTAMP</span><span style="color: #000000">(),</span><span style="color: #795E26">year</span><span style="color: #000000">)), INTERVAL </span><span style="color: #098658">1</span><span style="color: #000000"> </span><span style="color: #795E26">year</span><span style="color: #000000">)))</span><span style="color: #0000FF">and</span><span style="color: #000000">(order_items.created_at&lt;</span><span style="color: #0000FF">TIMESTAMP</span><span style="color: #000000">(DATETIME_ADD(</span><span style="color: #0000FF">DATETIME</span><span style="color: #000000">(</span><span style="color: #0000FF">TIMESTAMP</span><span style="color: #000000">(DATETIME_SUB(</span><span style="color: #0000FF">DATETIME</span><span style="color: #000000">(TIMESTAMP_TRUNC(</span><span style="color: #795E26">CURRENT_TIMESTAMP</span><span style="color: #000000">(),</span><span style="color: #795E26">year</span><span style="color: #000000">)), INTERVAL </span><span style="color: #098658">1</span><span style="color: #000000"> </span><span style="color: #795E26">year</span><span style="color: #000000">))), INTERVAL </span><span style="color: #098658">1</span><span style="color: #000000"> </span><span style="color: #795E26">year</span><span style="color: #000000">))) </span><span style="color: #0000FF">THEN</span><span style="color: #000000"> </span><span style="color: #098658">1</span><span style="color: #000000"> </span><span style="color: #0000FF">END</span><span style="color: #000000">))-(</span><span style="color: #795E26">COUNT</span><span style="color: #000000">( </span><span style="color: #0000FF">CASE</span><span style="color: #000000"> </span><span style="color: #0000FF">WHEN</span><span style="color: #000000"> (order_items.created_at&gt;=</span><span style="color: #0000FF">TIMESTAMP</span><span style="color: #000000">(DATETIME_SUB(</span><span style="color: #0000FF">DATETIME</span><span style="color: #000000">(TIMESTAMP_TRUNC(</span><span style="color: #795E26">CURRENT_TIMESTAMP</span><span style="color: #000000">(),</span><span style="color: #795E26">year</span><span style="color: #000000">)), INTERVAL </span><span style="color: #098658">2</span><span style="color: #000000"> </span><span style="color: #795E26">year</span><span style="color: #000000">)))</span><span style="color: #0000FF">and</span><span style="color: #000000">(order_items.created_at&lt;</span><span style="color: #0000FF">TIMESTAMP</span><span style="color: #000000">(DATETIME_ADD(</span><span style="color: #0000FF">DATETIME</span><span style="color: #000000">(</span><span style="color: #0000FF">TIMESTAMP</span><span style="color: #000000">(DATETIME_SUB(</span><span style="color: #0000FF">DATETIME</span><span style="color: #000000">(TIMESTAMP_TRUNC(</span><span style="color: #795E26">CURRENT_TIMESTAMP</span><span style="color: #000000">(),</span><span style="color: #795E26">year</span><span style="color: #000000">)), INTERVAL </span><span style="color: #098658">2</span><span style="color: #000000"> </span><span style="color: #795E26">year</span><span style="color: #000000">))), INTERVAL </span><span style="color: #098658">1</span><span style="color: #000000"> </span><span style="color: #795E26">year</span><span style="color: #000000">))) </span><span style="color: #0000FF">THEN</span><span style="color: #000000"> </span><span style="color: #098658">1</span><span style="color: #000000"> </span><span style="color: #0000FF">END</span><span style="color: #000000">))))/(</span><span style="color: #795E26">nullif</span><span style="color: #000000">((</span><span style="color: #795E26">COUNT</span><span style="color: #000000">( </span><span style="color: #0000FF">CASE</span><span style="color: #000000"> </span><span style="color: #0000FF">WHEN</span><span style="color: #000000"> (order_items.created_at&gt;=</span><span style="color: #0000FF">TIMESTAMP</span><span style="color: #000000">(DATETIME_SUB(</span><span style="color: #0000FF">DATETIME</span><span style="color: #000000">(TIMESTAMP_TRUNC(</span><span style="color: #795E26">CURRENT_TIMESTAMP</span><span style="color: #000000">(),</span><span style="color: #795E26">year</span><span style="color: #000000">)), INTERVAL </span><span style="color: #098658">2</span><span style="color: #000000"> </span><span style="color: #795E26">year</span><span style="color: #000000">)))</span><span style="color: #0000FF">and</span><span style="color: #000000">(order_items.created_at&lt;</span><span style="color: #0000FF">TIMESTAMP</span><span style="color: #000000">(DATETIME_ADD(</span><span style="color: #0000FF">DATETIME</span><span style="color: #000000">(</span><span style="color: #0000FF">TIMESTAMP</span><span style="color: #000000">(DATETIME_SUB(</span><span style="color: #0000FF">DATETIME</span><span style="color: #000000">(TIMESTAMP_TRUNC(</span><span style="color: #795E26">CURRENT_TIMESTAMP</span><span style="color: #000000">(),</span><span style="color: #795E26">year</span><span style="color: #000000">)), INTERVAL </span><span style="color: #098658">2</span><span style="color: #000000"> </span><span style="color: #795E26">year</span><span style="color: #000000">))), INTERVAL </span><span style="color: #098658">1</span><span style="color: #000000"> </span><span style="color: #795E26">year</span><span style="color: #000000">))) </span><span style="color: #0000FF">THEN</span><span style="color: #000000"> </span><span style="color: #098658">1</span><span style="color: #000000"> </span><span style="color: #0000FF">END</span><span style="color: #000000">)),</span><span style="color: #098658">0</span><span style="color: #000000">)))*</span><span style="color: #098658">100</span><span style="color: #000000">,</span><span style="color: #098658">1</span><span style="color: #000000">) </span><span style="color: #0000FF">as</span><span style="color: #000000"> percent_change</span></span>
<span class="line"><span style="color: #0000FF">FROM</span><span style="color: #000000"> </span><span style="color: #A31515">`malloy-data.ecomm.order_items`</span><span style="color: #000000"> </span><span style="color: #0000FF">as</span><span style="color: #000000"> order_items</span></span>
<span class="line"><span style="color: #0000FF">LEFT JOIN</span><span style="color: #000000"> </span><span style="color: #A31515">`malloy-data.ecomm.inventory_items`</span><span style="color: #000000"> </span><span style="color: #0000FF">AS</span><span style="color: #000000"> inventory_items_0</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #0000FF">ON</span><span style="color: #000000"> inventory_items_0.id=order_items.inventory_item_id</span></span>
<span class="line"><span style="color: #0000FF">GROUP BY</span><span style="color: #000000"> </span><span style="color: #098658">1</span></span>
<span class="line"><span style="color: #0000FF">ORDER BY</span><span style="color: #000000"> </span><span style="color: #098658">2</span><span style="color: #000000"> </span><span style="color: #0000FF">desc</span></span>
<span class="line"><span style="color: #0000FF">LIMIT</span><span style="color: #000000"> </span><span style="color: #098658">10</span></span>
<span class="line"></span></pre></pre>
      </div>
    </div>
  </div>
      <h3>
        <a id="declaring-and-reusing-common-expressions" class="header-link anchor" href="#declaring-and-reusing-common-expressions">
          Declaring and reusing common expressions
        </a>
      </h3>
    <p>We can rewrite the query so it is more reusable.  The declarations after the source are temporary additions to this order_items table for the sake of just this query.</p>
<pre class="language-malloy" style="background-color: #FBFBFB"><span class="line"><span style="color: #008000">-- common calculation for order_items</span></span>
<span class="line"><span style="color: #AF00DB">source</span><span style="color: #000000">: </span><span style="color: #001080">inventory_items</span><span style="color: #000000"> </span><span style="color: #AF00DB">is</span><span style="color: #000000"> </span><span style="color: #795E26">table</span><span style="color: #000000">(</span><span style="color: #A31515">&#39;malloy-data.ecomm.inventory_items&#39;</span><span style="color: #000000">) {</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #AF00DB">primary_key</span><span style="color: #000000">: </span><span style="color: #001080">id</span></span>
<span class="line"><span style="color: #000000">}</span></span>
<span class="line"></span>
<span class="line"><span style="color: #AF00DB">source</span><span style="color: #000000">: </span><span style="color: #001080">order_items</span><span style="color: #000000"> </span><span style="color: #AF00DB">is</span><span style="color: #000000"> </span><span style="color: #795E26">table</span><span style="color: #000000">(</span><span style="color: #A31515">&#39;malloy-data.ecomm.order_items&#39;</span><span style="color: #000000">) {</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #AF00DB">join_one</span><span style="color: #000000">: </span><span style="color: #001080">inventory_items</span><span style="color: #000000">  </span><span style="color: #AF00DB">with</span><span style="color: #000000"> </span><span style="color: #001080">inventory_item_id</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #AF00DB">measure</span><span style="color: #000000">: </span><span style="color: #001080">order_item_count</span><span style="color: #000000"> </span><span style="color: #AF00DB">is</span><span style="color: #000000"> </span><span style="color: #795E26">count</span><span style="color: #000000">()</span></span>
<span class="line"><span style="color: #000000">}</span></span>
<span class="line"></span>
<span class="line"><span style="color: #AF00DB">query</span><span style="color: #000000">: </span><span style="color: #001080">order_items</span><span style="color: #000000">{</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #AF00DB">measure</span><span style="color: #000000">:</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #008000">// these caclulations can be used in multipe parts of the query</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #001080">last_year</span><span style="color: #000000"> </span><span style="color: #AF00DB">is</span><span style="color: #000000"> </span><span style="color: #001080">order_item_count</span><span style="color: #000000"> { </span><span style="color: #AF00DB">where</span><span style="color: #000000">: </span><span style="color: #001080">created_at</span><span style="color: #000000"> ? </span><span style="color: #001080">now</span><span style="color: #000000">.</span><span style="color: #0000FF">year</span><span style="color: #000000"> - </span><span style="color: #098658">1</span><span style="color: #000000"> </span><span style="color: #0000FF">year</span><span style="color: #000000"> }</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #001080">prior_year</span><span style="color: #000000"> </span><span style="color: #AF00DB">is</span><span style="color: #000000"> </span><span style="color: #001080">order_item_count</span><span style="color: #000000"> { </span><span style="color: #AF00DB">where</span><span style="color: #000000">: </span><span style="color: #001080">created_at</span><span style="color: #000000"> ? </span><span style="color: #001080">now</span><span style="color: #000000">.</span><span style="color: #0000FF">year</span><span style="color: #000000"> - </span><span style="color: #098658">2</span><span style="color: #000000"> </span><span style="color: #0000FF">years</span><span style="color: #000000"> }</span></span>
<span class="line"><span style="color: #000000">} -&gt; {</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #AF00DB">top</span><span style="color: #000000">: </span><span style="color: #098658">10</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #AF00DB">group_by</span><span style="color: #000000">: </span><span style="color: #001080">inventory_items</span><span style="color: #000000">.</span><span style="color: #001080">product_category</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #AF00DB">aggregate</span><span style="color: #000000">:</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #001080">last_year</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #001080">prior_year</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #001080">percent_change</span><span style="color: #000000"> </span><span style="color: #AF00DB">is</span><span style="color: #000000"> </span><span style="color: #795E26">round</span><span style="color: #000000">(</span></span>
<span class="line"><span style="color: #000000">      (</span><span style="color: #001080">last_year</span><span style="color: #000000"> - </span><span style="color: #001080">prior_year</span><span style="color: #000000">) / </span><span style="color: #795E26">nullif</span><span style="color: #000000">(</span><span style="color: #001080">last_year</span><span style="color: #000000">, </span><span style="color: #098658">0</span><span style="color: #000000">) * </span><span style="color: #098658">100</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #098658">1</span></span>
<span class="line"><span style="color: #000000">    )</span></span>
<span class="line"><span style="color: #000000">}</span></span></pre><div class="result-outer medium">
    <div class="result-controls-bar">
      <span class="result-label">QUERY RESULTS</span>
      <div class="result-controls">
        <button class="result-control" selected data-result-kind="html">HTML</button>
        <button class="result-control"  data-result-kind="json">JSON</button>
        <button class="result-control"  data-result-kind="sql">SQL</button>
      </div>
    </div>
    <div class="result-middle" data-result-kind="html" selected>
      <div class="result-inner">
        <table style="vertical-align: top; border-collapse: collapse; width: 100%;"><thead><tr><th style="padding: 8px; text-align: left;">product_​category</th><th style="padding: 8px; text-align: right;">last_​year</th><th style="padding: 8px; text-align: right;">prior_​year</th><th style="padding: 8px; text-align: right;">percent_​change</th></tr></thead><tbody><tr><td style="padding: 8px; vertical-align: top;"><span>Accessories</span></td><td style="padding: 8px; vertical-align: top; text-align: right;"><span>10,380</span></td><td style="padding: 8px; vertical-align: top; text-align: right;"><span>6,857</span></td><td style="padding: 8px; vertical-align: top; text-align: right;"><span>33.9</span></td></tr><tr><td style="padding: 8px; vertical-align: top;"><span>Jeans</span></td><td style="padding: 8px; vertical-align: top; text-align: right;"><span>9,756</span></td><td style="padding: 8px; vertical-align: top; text-align: right;"><span>6,639</span></td><td style="padding: 8px; vertical-align: top; text-align: right;"><span>31.9</span></td></tr><tr><td style="padding: 8px; vertical-align: top;"><span>Tops &amp; Tees</span></td><td style="padding: 8px; vertical-align: top; text-align: right;"><span>8,448</span></td><td style="padding: 8px; vertical-align: top; text-align: right;"><span>5,561</span></td><td style="padding: 8px; vertical-align: top; text-align: right;"><span>34.2</span></td></tr><tr><td style="padding: 8px; vertical-align: top;"><span>Active</span></td><td style="padding: 8px; vertical-align: top; text-align: right;"><span>7,164</span></td><td style="padding: 8px; vertical-align: top; text-align: right;"><span>4,934</span></td><td style="padding: 8px; vertical-align: top; text-align: right;"><span>31.1</span></td></tr><tr><td style="padding: 8px; vertical-align: top;"><span>Shorts</span></td><td style="padding: 8px; vertical-align: top; text-align: right;"><span>6,311</span></td><td style="padding: 8px; vertical-align: top; text-align: right;"><span>4,211</span></td><td style="padding: 8px; vertical-align: top; text-align: right;"><span>33.3</span></td></tr><tr><td style="padding: 8px; vertical-align: top;"><span>Pants</span></td><td style="padding: 8px; vertical-align: top; text-align: right;"><span>4,750</span></td><td style="padding: 8px; vertical-align: top; text-align: right;"><span>3,213</span></td><td style="padding: 8px; vertical-align: top; text-align: right;"><span>32.4</span></td></tr><tr><td style="padding: 8px; vertical-align: top;"><span>Outerwear &amp; Coats</span></td><td style="padding: 8px; vertical-align: top; text-align: right;"><span>4,073</span></td><td style="padding: 8px; vertical-align: top; text-align: right;"><span>2,832</span></td><td style="padding: 8px; vertical-align: top; text-align: right;"><span>30.5</span></td></tr><tr><td style="padding: 8px; vertical-align: top;"><span>Fashion Hoodies &amp; Sweatshirts</span></td><td style="padding: 8px; vertical-align: top; text-align: right;"><span>4,057</span></td><td style="padding: 8px; vertical-align: top; text-align: right;"><span>2,604</span></td><td style="padding: 8px; vertical-align: top; text-align: right;"><span>35.8</span></td></tr><tr><td style="padding: 8px; vertical-align: top;"><span>Dresses</span></td><td style="padding: 8px; vertical-align: top; text-align: right;"><span>3,809</span></td><td style="padding: 8px; vertical-align: top; text-align: right;"><span>2,436</span></td><td style="padding: 8px; vertical-align: top; text-align: right;"><span>36</span></td></tr><tr><td style="padding: 8px; vertical-align: top;"><span>Sweaters</span></td><td style="padding: 8px; vertical-align: top; text-align: right;"><span>3,489</span></td><td style="padding: 8px; vertical-align: top; text-align: right;"><span>2,339</span></td><td style="padding: 8px; vertical-align: top; text-align: right;"><span>33</span></td></tr></tbody></table>
      </div>
    </div>
    <div class="result-middle" data-result-kind="json" >
      <div class="result-inner">
        <pre><pre class="language-json" style="background-color: #FBFBFB"><span class="line"><span style="color: #000000">[</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;product_category&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;Accessories&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;last_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">10380</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;prior_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">6857</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;percent_change&quot;</span><span style="color: #000000">: </span><span style="color: #098658">33.9</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;product_category&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;Jeans&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;last_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">9756</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;prior_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">6639</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;percent_change&quot;</span><span style="color: #000000">: </span><span style="color: #098658">31.9</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;product_category&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;Tops &amp; Tees&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;last_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">8448</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;prior_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">5561</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;percent_change&quot;</span><span style="color: #000000">: </span><span style="color: #098658">34.2</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;product_category&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;Active&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;last_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">7164</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;prior_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">4934</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;percent_change&quot;</span><span style="color: #000000">: </span><span style="color: #098658">31.1</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;product_category&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;Shorts&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;last_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">6311</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;prior_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">4211</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;percent_change&quot;</span><span style="color: #000000">: </span><span style="color: #098658">33.3</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;product_category&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;Pants&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;last_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">4750</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;prior_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">3213</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;percent_change&quot;</span><span style="color: #000000">: </span><span style="color: #098658">32.4</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;product_category&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;Outerwear &amp; Coats&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;last_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">4073</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;prior_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">2832</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;percent_change&quot;</span><span style="color: #000000">: </span><span style="color: #098658">30.5</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;product_category&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;Fashion Hoodies &amp; Sweatshirts&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;last_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">4057</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;prior_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">2604</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;percent_change&quot;</span><span style="color: #000000">: </span><span style="color: #098658">35.8</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;product_category&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;Dresses&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;last_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">3809</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;prior_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">2436</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;percent_change&quot;</span><span style="color: #000000">: </span><span style="color: #098658">36</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"><span style="color: #000000">  {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;product_category&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;Sweaters&quot;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;last_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">3489</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;prior_year&quot;</span><span style="color: #000000">: </span><span style="color: #098658">2339</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">&quot;percent_change&quot;</span><span style="color: #000000">: </span><span style="color: #098658">33</span></span>
<span class="line"><span style="color: #000000">  }</span></span>
<span class="line"><span style="color: #000000">]</span></span></pre></pre>
      </div>
    </div>
    <div class="result-middle" data-result-kind="sql" >
      <div class="result-inner">
        <pre><pre class="language-sql" style="background-color: #FBFBFB"><span class="line"><span style="color: #0000FF">SELECT</span><span style="color: #000000"> </span></span>
<span class="line"><span style="color: #000000">   inventory_items_0.product_category </span><span style="color: #0000FF">as</span><span style="color: #000000"> product_category,</span></span>
<span class="line"><span style="color: #000000">   (</span><span style="color: #795E26">COUNT</span><span style="color: #000000">( </span><span style="color: #0000FF">CASE</span><span style="color: #000000"> </span><span style="color: #0000FF">WHEN</span><span style="color: #000000"> (order_items.created_at&gt;=</span><span style="color: #0000FF">TIMESTAMP</span><span style="color: #000000">(DATETIME_SUB(</span><span style="color: #0000FF">DATETIME</span><span style="color: #000000">(TIMESTAMP_TRUNC(</span><span style="color: #795E26">CURRENT_TIMESTAMP</span><span style="color: #000000">(),</span><span style="color: #795E26">year</span><span style="color: #000000">)), INTERVAL </span><span style="color: #098658">1</span><span style="color: #000000"> </span><span style="color: #795E26">year</span><span style="color: #000000">)))</span><span style="color: #0000FF">and</span><span style="color: #000000">(order_items.created_at&lt;</span><span style="color: #0000FF">TIMESTAMP</span><span style="color: #000000">(DATETIME_ADD(</span><span style="color: #0000FF">DATETIME</span><span style="color: #000000">(</span><span style="color: #0000FF">TIMESTAMP</span><span style="color: #000000">(DATETIME_SUB(</span><span style="color: #0000FF">DATETIME</span><span style="color: #000000">(TIMESTAMP_TRUNC(</span><span style="color: #795E26">CURRENT_TIMESTAMP</span><span style="color: #000000">(),</span><span style="color: #795E26">year</span><span style="color: #000000">)), INTERVAL </span><span style="color: #098658">1</span><span style="color: #000000"> </span><span style="color: #795E26">year</span><span style="color: #000000">))), INTERVAL </span><span style="color: #098658">1</span><span style="color: #000000"> </span><span style="color: #795E26">year</span><span style="color: #000000">))) </span><span style="color: #0000FF">THEN</span><span style="color: #000000"> </span><span style="color: #098658">1</span><span style="color: #000000"> </span><span style="color: #0000FF">END</span><span style="color: #000000">)) </span><span style="color: #0000FF">as</span><span style="color: #000000"> last_year,</span></span>
<span class="line"><span style="color: #000000">   (</span><span style="color: #795E26">COUNT</span><span style="color: #000000">( </span><span style="color: #0000FF">CASE</span><span style="color: #000000"> </span><span style="color: #0000FF">WHEN</span><span style="color: #000000"> (order_items.created_at&gt;=</span><span style="color: #0000FF">TIMESTAMP</span><span style="color: #000000">(DATETIME_SUB(</span><span style="color: #0000FF">DATETIME</span><span style="color: #000000">(TIMESTAMP_TRUNC(</span><span style="color: #795E26">CURRENT_TIMESTAMP</span><span style="color: #000000">(),</span><span style="color: #795E26">year</span><span style="color: #000000">)), INTERVAL </span><span style="color: #098658">2</span><span style="color: #000000"> </span><span style="color: #795E26">year</span><span style="color: #000000">)))</span><span style="color: #0000FF">and</span><span style="color: #000000">(order_items.created_at&lt;</span><span style="color: #0000FF">TIMESTAMP</span><span style="color: #000000">(DATETIME_ADD(</span><span style="color: #0000FF">DATETIME</span><span style="color: #000000">(</span><span style="color: #0000FF">TIMESTAMP</span><span style="color: #000000">(DATETIME_SUB(</span><span style="color: #0000FF">DATETIME</span><span style="color: #000000">(TIMESTAMP_TRUNC(</span><span style="color: #795E26">CURRENT_TIMESTAMP</span><span style="color: #000000">(),</span><span style="color: #795E26">year</span><span style="color: #000000">)), INTERVAL </span><span style="color: #098658">2</span><span style="color: #000000"> </span><span style="color: #795E26">year</span><span style="color: #000000">))), INTERVAL </span><span style="color: #098658">1</span><span style="color: #000000"> </span><span style="color: #795E26">year</span><span style="color: #000000">))) </span><span style="color: #0000FF">THEN</span><span style="color: #000000"> </span><span style="color: #098658">1</span><span style="color: #000000"> </span><span style="color: #0000FF">END</span><span style="color: #000000">)) </span><span style="color: #0000FF">as</span><span style="color: #000000"> prior_year,</span></span>
<span class="line"><span style="color: #000000">   </span><span style="color: #795E26">round</span><span style="color: #000000">(((((</span><span style="color: #795E26">COUNT</span><span style="color: #000000">( </span><span style="color: #0000FF">CASE</span><span style="color: #000000"> </span><span style="color: #0000FF">WHEN</span><span style="color: #000000"> (order_items.created_at&gt;=</span><span style="color: #0000FF">TIMESTAMP</span><span style="color: #000000">(DATETIME_SUB(</span><span style="color: #0000FF">DATETIME</span><span style="color: #000000">(TIMESTAMP_TRUNC(</span><span style="color: #795E26">CURRENT_TIMESTAMP</span><span style="color: #000000">(),</span><span style="color: #795E26">year</span><span style="color: #000000">)), INTERVAL </span><span style="color: #098658">1</span><span style="color: #000000"> </span><span style="color: #795E26">year</span><span style="color: #000000">)))</span><span style="color: #0000FF">and</span><span style="color: #000000">(order_items.created_at&lt;</span><span style="color: #0000FF">TIMESTAMP</span><span style="color: #000000">(DATETIME_ADD(</span><span style="color: #0000FF">DATETIME</span><span style="color: #000000">(</span><span style="color: #0000FF">TIMESTAMP</span><span style="color: #000000">(DATETIME_SUB(</span><span style="color: #0000FF">DATETIME</span><span style="color: #000000">(TIMESTAMP_TRUNC(</span><span style="color: #795E26">CURRENT_TIMESTAMP</span><span style="color: #000000">(),</span><span style="color: #795E26">year</span><span style="color: #000000">)), INTERVAL </span><span style="color: #098658">1</span><span style="color: #000000"> </span><span style="color: #795E26">year</span><span style="color: #000000">))), INTERVAL </span><span style="color: #098658">1</span><span style="color: #000000"> </span><span style="color: #795E26">year</span><span style="color: #000000">))) </span><span style="color: #0000FF">THEN</span><span style="color: #000000"> </span><span style="color: #098658">1</span><span style="color: #000000"> </span><span style="color: #0000FF">END</span><span style="color: #000000">))-(</span><span style="color: #795E26">COUNT</span><span style="color: #000000">( </span><span style="color: #0000FF">CASE</span><span style="color: #000000"> </span><span style="color: #0000FF">WHEN</span><span style="color: #000000"> (order_items.created_at&gt;=</span><span style="color: #0000FF">TIMESTAMP</span><span style="color: #000000">(DATETIME_SUB(</span><span style="color: #0000FF">DATETIME</span><span style="color: #000000">(TIMESTAMP_TRUNC(</span><span style="color: #795E26">CURRENT_TIMESTAMP</span><span style="color: #000000">(),</span><span style="color: #795E26">year</span><span style="color: #000000">)), INTERVAL </span><span style="color: #098658">2</span><span style="color: #000000"> </span><span style="color: #795E26">year</span><span style="color: #000000">)))</span><span style="color: #0000FF">and</span><span style="color: #000000">(order_items.created_at&lt;</span><span style="color: #0000FF">TIMESTAMP</span><span style="color: #000000">(DATETIME_ADD(</span><span style="color: #0000FF">DATETIME</span><span style="color: #000000">(</span><span style="color: #0000FF">TIMESTAMP</span><span style="color: #000000">(DATETIME_SUB(</span><span style="color: #0000FF">DATETIME</span><span style="color: #000000">(TIMESTAMP_TRUNC(</span><span style="color: #795E26">CURRENT_TIMESTAMP</span><span style="color: #000000">(),</span><span style="color: #795E26">year</span><span style="color: #000000">)), INTERVAL </span><span style="color: #098658">2</span><span style="color: #000000"> </span><span style="color: #795E26">year</span><span style="color: #000000">))), INTERVAL </span><span style="color: #098658">1</span><span style="color: #000000"> </span><span style="color: #795E26">year</span><span style="color: #000000">))) </span><span style="color: #0000FF">THEN</span><span style="color: #000000"> </span><span style="color: #098658">1</span><span style="color: #000000"> </span><span style="color: #0000FF">END</span><span style="color: #000000">))))/(</span><span style="color: #795E26">nullif</span><span style="color: #000000">((</span><span style="color: #795E26">COUNT</span><span style="color: #000000">( </span><span style="color: #0000FF">CASE</span><span style="color: #000000"> </span><span style="color: #0000FF">WHEN</span><span style="color: #000000"> (order_items.created_at&gt;=</span><span style="color: #0000FF">TIMESTAMP</span><span style="color: #000000">(DATETIME_SUB(</span><span style="color: #0000FF">DATETIME</span><span style="color: #000000">(TIMESTAMP_TRUNC(</span><span style="color: #795E26">CURRENT_TIMESTAMP</span><span style="color: #000000">(),</span><span style="color: #795E26">year</span><span style="color: #000000">)), INTERVAL </span><span style="color: #098658">1</span><span style="color: #000000"> </span><span style="color: #795E26">year</span><span style="color: #000000">)))</span><span style="color: #0000FF">and</span><span style="color: #000000">(order_items.created_at&lt;</span><span style="color: #0000FF">TIMESTAMP</span><span style="color: #000000">(DATETIME_ADD(</span><span style="color: #0000FF">DATETIME</span><span style="color: #000000">(</span><span style="color: #0000FF">TIMESTAMP</span><span style="color: #000000">(DATETIME_SUB(</span><span style="color: #0000FF">DATETIME</span><span style="color: #000000">(TIMESTAMP_TRUNC(</span><span style="color: #795E26">CURRENT_TIMESTAMP</span><span style="color: #000000">(),</span><span style="color: #795E26">year</span><span style="color: #000000">)), INTERVAL </span><span style="color: #098658">1</span><span style="color: #000000"> </span><span style="color: #795E26">year</span><span style="color: #000000">))), INTERVAL </span><span style="color: #098658">1</span><span style="color: #000000"> </span><span style="color: #795E26">year</span><span style="color: #000000">))) </span><span style="color: #0000FF">THEN</span><span style="color: #000000"> </span><span style="color: #098658">1</span><span style="color: #000000"> </span><span style="color: #0000FF">END</span><span style="color: #000000">)),</span><span style="color: #098658">0</span><span style="color: #000000">)))*</span><span style="color: #098658">100</span><span style="color: #000000">,</span><span style="color: #098658">1</span><span style="color: #000000">) </span><span style="color: #0000FF">as</span><span style="color: #000000"> percent_change</span></span>
<span class="line"><span style="color: #0000FF">FROM</span><span style="color: #000000"> </span><span style="color: #A31515">`malloy-data.ecomm.order_items`</span><span style="color: #000000"> </span><span style="color: #0000FF">as</span><span style="color: #000000"> order_items</span></span>
<span class="line"><span style="color: #0000FF">LEFT JOIN</span><span style="color: #000000"> </span><span style="color: #A31515">`malloy-data.ecomm.inventory_items`</span><span style="color: #000000"> </span><span style="color: #0000FF">AS</span><span style="color: #000000"> inventory_items_0</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #0000FF">ON</span><span style="color: #000000"> inventory_items_0.id=order_items.inventory_item_id</span></span>
<span class="line"><span style="color: #0000FF">GROUP BY</span><span style="color: #000000"> </span><span style="color: #098658">1</span></span>
<span class="line"><span style="color: #0000FF">ORDER BY</span><span style="color: #000000"> </span><span style="color: #098658">2</span><span style="color: #000000"> </span><span style="color: #0000FF">desc</span></span>
<span class="line"><span style="color: #0000FF">LIMIT</span><span style="color: #000000"> </span><span style="color: #098658">10</span></span>
<span class="line"></span></pre></pre>
      </div>
    </div>
  </div></div>